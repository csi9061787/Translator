REPLACE PROCEDURE PMART.CREATE_VOLATILE_TABLE()
SQL SECURITY INVOKER
SP:BEGIN
	DECLARE SQLSTR  VARCHAR(4000);
   CALL PMART.P_DROP_TABLE ('#VT_TT_CTFACT_FUNC'); 
   CALL PMART.P_DROP_TABLE ('#VT_TT_CTFACT_FUNC_T1');  
   SET SQLSTR =  'CREATE MULTISET VOLATILE TABLE #VT_TT_CTFACT_FUNC  
   (
      TIME_ID		NUMBER,
      TR_ID		NUMBER,
      CUST_NUM	NUMBER
    )
   NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;';
   EXECUTE IMMEDIATE SQLSTR; 
    SET SQLSTR = 'CREATE MULTISET VOLATILE TABLE #VT_TT_CTFACT_FUNC_T1  AS('+
      'SELECT   TIME_ID,'+
      'SUM(TR00) AS TR00,SUM(TR01) AS TR01,'+
      'SUM(TR02) AS TR02,SUM(TR03) AS TR03,'+
      'SUM(TR04) AS TR04,SUM(TR05) AS TR05,'+
      'SUM(TR06) AS TR06,SUM(TR07) AS TR07,'+
      'SUM(TR08) AS TR08,SUM(TR09) AS TR09,'+
      'SUM(TR10) AS TR10,SUM(TR11) AS TR11,'+
      'SUM(TR12) AS TR12,SUM(TR13) AS TR13,'+
      'SUM(TR14) AS TR14,SUM(TR15) AS TR15,'+
      'SUM(TR16) AS TR16,SUM(TR17) AS TR17,'+
      'SUM(TR18) AS TR18,SUM(TR19) AS TR19,'+
      'SUM(TR20) AS TR20,SUM(TR21) AS TR21,'+
      'SUM(TR22) AS TR22,SUM(TR23) AS TR23 '+
      'FROM PMART.SALES_CTFACT '+
      ' GROUP BY TIME_ID'+
      ') WITH NO DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;';
	EXECUTE IMMEDIATE SQLSTR;
END SP;