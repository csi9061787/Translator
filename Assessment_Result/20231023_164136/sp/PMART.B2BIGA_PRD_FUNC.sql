REPLACE PROCEDURE PMART.B2BIGA_PRD_FUNC
(
	IN P_MRNO_LIST VARCHAR(2000),
	IN P_PRD_NAME VARCHAR(60) CHARACTER SET UNICODE
)
SQL SECURITY INVOKER
SP:BEGIN
	DECLARE SQLSTR VARCHAR(20000) ;
	CALL PMART.P_DROP_TABLE ('#VT_B2BIGA_PRD_FUNC');
	SET SQLSTR ='CREATE MULTISET VOLATILE TABLE #VT_B2BIGA_PRD_FUNC  AS( '
	+ ' SELECT DISTINCT X.FM_CODE AS PRD_ID, X.FM_CODE + '' '' + X.FM_NAME AS PRD '
	+ ' FROM PDATA.PBMCMDT X, PDATA.PBMCMDT_VD Y '
	+ ' WHERE X.FM_CODE = Y.FM_CODE '
	+ ' AND Y.VENDOR_NO IN ('+ PMART.CONVERT_STRING_LIST(P_MRNO_LIST) +') '
	+ ' AND X.FM_NAME LIKE ''%'+ P_PRD_NAME +'%'' '
	+ ' ) WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;' ; 
	EXECUTE IMMEDIATE SQLSTR;
END SP;