REPLACE PROCEDURE PDATA.PRDREL_SET_COPY
(
    IN  I_JOB_ID BIGINT,   
	IN I_EMP_NO VARCHAR(10),   
	OUT O_NEWJOB_ID BIGINT   
)
SP:BEGIN
	DECLARE V_NEWJOB_ID BIGINT;
	DECLARE V_EMP_NAME VARCHAR(30);
	DECLARE V_DEPT_ID1 VARCHAR(6);
	DECLARE V_DEPT_ID VARCHAR(6);
	SELECT EMP_NAME, EMP_DEPT_NO 
		INTO V_EMP_NAME, V_DEPT_ID
	FROM PDATA.PBMEMP 
	WHERE EMP_NO=I_EMP_NO;
	SELECT NVL(B.PARENT_DEPT_ID, NVL(B.DEPT_ID, A.DEPT_ID)) INTO V_DEPT_ID1
	FROM PDATA.PBMDEPT A  
		LEFT JOIN PDATA.PBMDEPT B ON A.PARENT_DEPT_ID=B.DEPT_ID  
	WHERE A.DEPT_ID=V_DEPT_ID;
	CALL PDATA.PRDREL_JOB_ID_GET(); 
	SELECT JOB_ID INTO V_NEWJOB_ID FROM #VT_PRDREL_JOB_ID_GET;
	INSERT INTO PDATA.PRDREL_SET (
		JOB_ID, JOB_NAME, JOB_STATUS, 
		TX_SDT, TX_EDT, ORG_TYPE, 
		ORG_ID, MMA_ID, PRD_TYPE, 
		WEIGHT, SUPPORT, TRG_PERSON, 
		PROMO, DEPT_ID1, OWNER_NO, 
		OWNER_NAME, SET_DT, ETL_DT, 
		CAL_DT, DISABLE_DT, BB_THRES,
		ALSO_TGT, ALSO_BUY)
	SELECT 
		V_NEWJOB_ID, JOB_NAME + '[複製]', 10, 
		TX_SDT, TX_EDT, ORG_TYPE, 
		ORG_ID, MMA_ID, PRD_TYPE, 
		WEIGHT, SUPPORT, TRG_PERSON, 
		PROMO, V_DEPT_ID1, I_EMP_NO, 
		V_EMP_NAME, CURRENT_TIMESTAMP(0), NULL, 
		NULL, NULL, BB_THRES,
		ALSO_TGT, ALSO_BUY
	FROM PDATA.PRDREL_SET
	WHERE JOB_ID = I_JOB_ID;
	INSERT INTO PDATA.PRDREL_PRD_SET (
		JOB_ID, SET_TYPE, PRD_ID, 
		PRD_LVL)
	SELECT 
		V_NEWJOB_ID, SET_TYPE, PRD_ID, 
		PRD_LVL
	FROM PDATA.PRDREL_PRD_SET
	WHERE JOB_ID = I_JOB_ID;
	INSERT INTO PDATA.PRDREL_CAGE_SET (
		JOB_ID, AGE_BGN, AGE_END)
	SELECT 
		V_NEWJOB_ID, AGE_BGN, AGE_END
	FROM PDATA.PRDREL_CAGE_SET
	WHERE JOB_ID = I_JOB_ID;
	INSERT INTO PDATA.PRDREL_CSEX_SET (
		JOB_ID, SEX_TYPE)
	SELECT 
		V_NEWJOB_ID, SEX_TYPE
	FROM PDATA.PRDREL_CSEX_SET
	WHERE JOB_ID = I_JOB_ID;
	INSERT INTO PDATA.PRDREL_POMO_SET (
		JOB_ID, MONTH_ID, MM_ID)
	SELECT 
		V_NEWJOB_ID, MONTH_ID, MM_ID
	FROM PDATA.PRDREL_POMO_SET
	WHERE JOB_ID = I_JOB_ID;
	INSERT INTO PDATA.PRDREL_TIME_SET (
		JOB_ID, TIME_BGN, TIME_END, TIME_SEQ)
	SELECT 
		V_NEWJOB_ID, TIME_BGN, TIME_END, TIME_SEQ
	FROM PDATA.PRDREL_TIME_SET
	WHERE JOB_ID = I_JOB_ID;
	INSERT INTO PDATA.PRDREL_STOR_SET (
		JOB_ID, ORG_LVL, ORG_ID)
	SELECT 
		V_NEWJOB_ID, ORG_LVL, ORG_ID
	FROM PDATA.PRDREL_STOR_SET
	WHERE JOB_ID = I_JOB_ID;	
	SET O_NEWJOB_ID = V_NEWJOB_ID;
END SP;