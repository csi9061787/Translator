REPLACE PROCEDURE PMART.B2BIGA_1_3_KIND_FUNC
(
	IN P_MRNO_LIST VARCHAR(2000)
)
SQL SECURITY INVOKER
SP:BEGIN
   DECLARE SQLSTR VARCHAR(20000);
   DECLARE SQLSTR2 VARCHAR(20000);
   CALL PMART.P_DROP_TABLE ('#VT_B2BIGA_1_3_KGRP'); 
   SET SQLSTR ='CREATE MULTISET VOLATILE TABLE #VT_B2BIGA_1_3_KGRP  AS( '
        + ' SELECT DISTINCT A.KGRP_KIND_CODE AS KIND_CODE,  A.KGRP_GROUP_CODE AS GROUP_CODE '
		+ ' FROM PDATA.PBMCMDT A, PDATA.PBMCMDT_VD B '
		+ ' WHERE A.FM_CODE = B.FM_CODE '
		+ ' AND B.VENDOR_NO IN ('+ PMART.CONVERT_STRING_LIST(P_MRNO_LIST) +') '
		+ ' ) WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;' ; 
	EXECUTE IMMEDIATE SQLSTR;
   CALL PMART.P_DROP_TABLE ('#VT_B2BIGA_1_3_KIND_FUNC'); 
   SET SQLSTR2 ='CREATE MULTISET VOLATILE TABLE #VT_B2BIGA_1_3_KIND_FUNC  AS( '
        + ' SELECT DISTINCT A.KIND_CODE, B.KIND_NAME  '
		+ ' FROM #VT_B2BIGA_1_3_KGRP A, PDATA.PBMKGRP B '
		+ ' WHERE A.KIND_CODE = B.KIND_CODE '
		+ ' AND A.GROUP_CODE = B.GROUP_CODE '
		+ ' ) WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;' ; 
	EXECUTE IMMEDIATE SQLSTR2;
END SP;