REPLACE PROCEDURE PMART.REMD_T4_GRP_FUNC()
SQL SECURITY INVOKER
SP:BEGIN
DECLARE SQLSTR  VARCHAR(4000) DEFAULT ''; 
  CALL PMART.P_DROP_TABLE ('#VT_REMD_T4_GRP_FUNC'); 
      SET SQLSTR = 
          'CREATE MULTISET VOLATILE TABLE #VT_REMD_T4_GRP_FUNC AS('+            
               'SELECT M.GRP_ID AS STYPE_ID, '+
               '     COUNT(D.GRP_ID) AS MAST_STORE_NUM '+
               'FROM PMART.REMD_GRP_M M '+
               'LEFT JOIN PMART.REMD_GRP_D D ON M.GRP_ID = D.GRP_ID '+
               'GROUP BY M.GRP_ID '+
           ' ) WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;';
    EXECUTE IMMEDIATE SQLSTR; 
END SP;