REPLACE PROCEDURE PMART.TOOL_DATE_LIST
(
	IN M_START_DATE DATE,
	IN M_DAYS INTEGER,
	IN M_FIRSTDAY INTEGER,
	IN M_TMP_TABLE_NAME VARCHAR(100)
)
SQL SECURITY INVOKER
SP:BEGIN
	DECLARE M_QRY_SQL_STR   VARCHAR(500) DEFAULT '';
	DECLARE M_DEL_SQL_STR   VARCHAR(500) DEFAULT '';
	DECLARE M_CRT_SQL_STR   VARCHAR(2000) DEFAULT '';
	DECLARE M_END_DATE        DATE ;
	DECLARE M_REC_CNT            INTEGER;
	SET M_END_DATE  = M_START_DATE + M_DAYS - M_FIRSTDAY  ;
	SET M_DEL_SQL_STR = 'DROP TABLE PTEMP.' + M_TMP_TABLE_NAME +';';
	INSERT INTO PMART.T1(F1,F2) SELECT 7,M_DEL_SQL_STR;		
    EXECUTE IMMEDIATE M_DEL_SQL_STR;   
	SET M_CRT_SQL_STR = ' CREATE TABLE PTEMP.'+M_TMP_TABLE_NAME+' AS (  ' 
	                                         + ' SELECT CALENDAR_DATE ' 
											 + ' FROM SYS_CALENDAR.CALENDAR  '
											 + ' WHERE CALENDAR_DATE BETWEEN ' +'''' +CAST(M_START_DATE AS FORMAT 'YYYY-MM-DD') +''''
											 + ' AND ' + ''''+ CAST(M_END_DATE AS FORMAT 'YYYY-MM-DD') +''''
											 + ' ) WITH DATA PRIMARY INDEX (CALENDAR_DATE) ; ' ;
	EXECUTE IMMEDIATE M_CRT_SQL_STR;  
END SP;