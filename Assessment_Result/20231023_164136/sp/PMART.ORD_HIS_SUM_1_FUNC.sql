REPLACE PROCEDURE PMART.ORD_HIS_SUM_1_FUNC
(
	L_DAY_ID_S INTEGER,
	L_DAY_ID_E INTEGER,
	ORGSELECTLEVEL INTEGER,
	CURRENTORGID VARCHAR(10)
)            
SQL SECURITY INVOKER
SP:BEGIN
   DECLARE SQLSTR        VARCHAR(4000) ;
   DECLARE V_SQL              VARCHAR(4000) ;   
   DECLARE V_SQLWHERE     VARCHAR(1000) ; 
	CALL PMART.P_DROP_TABLE ('#VT_ORD_HIS_SUM_1_FUNC'); 
	CALL PMART.ORD_HIS_1_FUNC(L_DAY_ID_S, L_DAY_ID_E, ORGSELECTLEVEL, CURRENTORGID);
	SET SQLSTR = 'CREATE MULTISET VOLATILE TABLE #VT_ORD_HIS_SUM_1_FUNC  AS( '
							+ ' SELECT * FROM #VT_ORD_HIS_1_FUNC WHERE STORE_NO IS NOT NULL '
							+ ' ) WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;';
	EXECUTE IMMEDIATE SQLSTR;
END SP;