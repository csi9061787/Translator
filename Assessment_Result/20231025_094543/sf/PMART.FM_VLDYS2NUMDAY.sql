CREATE FUNCTION PMART.FM_VLDYS2NUMDAY(P_FM_VLDYS VARCHAR(4))
   RETURNS INTEGER
   LANGUAGE SQL
   CONTAINS SQL
   DETERMINISTIC
   SQL SECURITY DEFINER
   COLLATION INVOKER
   INLINE TYPE 1
   RETURN
CASE SUBSTRING(P_FM_VLDYS,1,1)
         WHEN 'H' THEN
           TRUNC(CAST(SUBSTRING(P_FM_VLDYS,2) AS INTEGER)/24)
         WHEN 'D' THEN
           TRUNC(CAST(SUBSTRING(P_FM_VLDYS,2) AS INTEGER))
         WHEN 'M' THEN
           TRUNC(CAST(SUBSTRING(P_FM_VLDYS,2) AS INTEGER)*30)
         WHEN 'Y' THEN
           TRUNC(CAST(SUBSTRING(P_FM_VLDYS,2) AS INTEGER)*365)
         ELSE
          NULL
       END;