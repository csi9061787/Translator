REPLACE FUNCTION PMART.OSTYPE_CONVERT(OOPNDT NUMBER)
RETURNS NUMBER
LANGUAGE SQL 
DETERMINISTIC 
CONTAINS SQL 
CALLED ON NULL INPUT
SQL SECURITY DEFINER
COLLATION INVOKER
INLINE TYPE 1 
RETURN
CASE 
		WHEN (ROUND(TO_NUMBER(TO_CHAR(DATE,'YYYYMMDD'))/10000)) = ROUND(OOPNDT/10000) THEN 
					1
		WHEN (ROUND(TO_NUMBER(TO_CHAR(DATE,'YYYYMMDD'))/10000))-1=ROUND(OOPNDT/10000) THEN 
				CASE WHEN ((ROUND(TO_NUMBER(TO_CHAR(DATE,'YYYYMMDD'))/10000))-1)*10000+(TO_NUMBER(TO_CHAR(DATE,'MM')))*100+1<= OOPNDT THEN
						2
				ELSE
						3
				END
		WHEN (ROUND(TO_NUMBER(TO_CHAR(DATE,'YYYYMMDD'))/10000))-2>= ROUND(OOPNDT/10000) THEN
					   4
		ELSE
					  -1
END;