REPLACE FUNCTION PMART.CONVERT_STRING_LIST_TEST(P_ITEM_LIST VARCHAR(2000))
   RETURNS VARCHAR(2000)
   LANGUAGE SQL
   CONTAINS SQL
   DETERMINISTIC
   SQL SECURITY DEFINER
   COLLATION INVOKER
   INLINE TYPE 1
    RETURN
'CREATE MULTISET VOLATILE TABLE #VT_PT_TCFACT_FUNC  AS('+
         'SELECT PRD_ID, TR_ID, SUM(CNT) CNT, SUM(AMT) AMT '+
		 ' FROM (  '+
		 '  SELECT  CAST(I.PRD_ID AS NUMBER) AS PRD_ID,   CAST(H.X AS NUMBER) AS TR_ID,   '+
         '             CAST(CASE WHEN I.TIME_RANGE = H.X THEN I.S_CNT ELSE 0 END AS NUMBER) AS CNT,  '+
         '             CAST(CASE WHEN I.TIME_RANGE = H.X THEN I.S_AMT ELSE 0 END AS NUMBER) AS AMT 	'+
         ' FROM PMART.FACT_SALES_TIME I ' +
         '  CROSS JOIN (SELECT CAST(DAY_OF_CALENDAR AS INTEGER) -1 AS X FROM SYS_CALENDAR.CALENDAR  WHERE X BETWEEN 0 AND 23 ) AS H '+
         ' WHERE I.TIME_ID=202268 ' +
         ' AND I.ORG_ID=3100000 '+
         ' AND I.PRD_ID IN (''021'',''02Z'') '+
		 ' ) S '+
         ' GROUP BY PRD_ID, TR_ID '+
    ') WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;