REPLACE PROCEDURE PMART.REMD_GRPID_SEQ()
SQL SECURITY INVOKER
SP:BEGIN
   DECLARE SQLSTR  VARCHAR(8000); 	
   DECLARE V_NEXT_SEQ NUMBER DEFAULT 1;
   DECLARE V_NEXTVAL  VARCHAR(5) ;
   DECLARE STORE_CS CURSOR FOR STORE_SQL;
   CALL PMART.P_DROP_TABLE ('#VT_REMD_GRPID_SEQ');    
   SET SQLSTR ='CREATE MULTISET VOLATILE TABLE #VT_REMD_GRPID_SEQ  
                (NEXT_SEQ NUMBER, NEXTVAL VARCHAR(5)
                ) NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;';
   EXECUTE IMMEDIATE SQLSTR;    
  SET SQLSTR =' SELECT (NEXT_SEQ+1) NNEXT_SEQ, LPAD(TO_CHAR(NEXT_SEQ+1),4,''0'') AS NNEXTVAL' +
              '   FROM PMART.REMD_GRPID_SEQNO '  ;
  PREPARE STORE_SQL FROM SQLSTR;
  OPEN STORE_CS;     
  L1:
  WHILE (SQLCODE =0) 
  DO
   L2:
    BEGIN 
         FETCH STORE_CS INTO V_NEXT_SEQ,V_NEXTVAL ;
         IF SQLSTATE <> '00000' THEN LEAVE L1; END IF;         
         IF(V_NEXT_SEQ < 10000) THEN             
	    INSERT INTO #VT_REMD_GRPID_SEQ(NEXT_SEQ,NEXTVAL) VALUES (V_NEXT_SEQ , V_NEXTVAL);
	    UPDATE PMART.REMD_GRPID_SEQNO SET NEXT_SEQ = NEXT_SEQ+1 ,NEXTVAL = LPAD(TO_CHAR(NEXT_SEQ+1),4,'0')  ;	 
	 ELSE
	    INSERT INTO #VT_REMD_GRPID_SEQ(NEXT_SEQ,NEXTVAL) VALUES (1 , '0001');
	    UPDATE PMART.REMD_GRPID_SEQNO SET NEXT_SEQ = 1 ,NEXTVAL = '0001'  ;
         END IF; 
   END L2;
  END WHILE L1;      
  CLOSE STORE_CS;
END SP;