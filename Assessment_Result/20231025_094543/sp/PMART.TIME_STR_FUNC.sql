REPLACE PROCEDURE PMART.TIME_STR_FUNC
(FP_TIME_TYPE CHAR CASESPECIFIC,FP_TIME_ID INTEGER)
SQL SECURITY INVOKER
SP:BEGIN
DECLARE SQLSTR  VARCHAR(4000);
DECLARE V_TIME_SERIAL INTEGER;
DECLARE V_TIME_STR VARCHAR(4000) DEFAULT '' ;
DECLARE I NUMBER DEFAULT 0;
   CALL PMART.P_DROP_TABLE ('#VT_TIME_STR_FUNC'); 
    SET SQLSTR = 'CREATE MULTISET VOLATILE TABLE #VT_TIME_STR_FUNC  ( 
                                   TIME_STR		VARCHAR(4000) 
                            )  NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;';
   EXECUTE IMMEDIATE SQLSTR;
   CALL PMART.TIME_FUNC(FP_TIME_TYPE,FP_TIME_ID);
	SET I = 0;		
	FOR LOOPVAR AS CUR1 CURSOR FOR
	SELECT TIME_ID, TIME_NM FROM #VT_TIME_FUNC ORDER BY TIME_ID
	DO 
	IF I=0 THEN
       SET V_TIME_STR = V_TIME_STR + TRIM(LOOPVAR.TIME_ID);
    ELSE
       SET  V_TIME_STR = V_TIME_STR +','+  TRIM(LOOPVAR.TIME_ID);
    END IF;
    SET I = 1;	
	END FOR;	
	INSERT INTO #VT_TIME_STR_FUNC(TIME_STR) VALUES (V_TIME_STR);
END SP;