REPLACE PROCEDURE PMART.BASIC_TIME_RANGE_USELF(FP_TIME_TYPE CHAR(1)  CASESPECIFIC ,FP_TIME_IDS NUMBER,FP_TIME_IDE NUMBER)
SQL SECURITY INVOKER
SP:BEGIN
   CALL PMART.P_DROP_TABLE ('#VT_BASIC_TIME_RANGE_USELF');
   CASE  FP_TIME_TYPE
      WHEN 'I' THEN
           CREATE MULTISET VOLATILE TABLE #VT_BASIC_TIME_RANGE_USELF AS(
             SELECT MIN(L_DAY_ID) AS START_DAY,
             MAX(L_DAY_ID) AS END_DAY
             FROM PMART.YMWD_TIME 
             WHERE L_DAY_ID>=FP_TIME_IDS
               AND L_DAY_ID<=FP_TIME_IDE
          ) WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;   
   END CASE;
END SP;