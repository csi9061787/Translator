REPLACE  PROCEDURE PMART.FUNC_TSC_PRD_WARNING_HOUR_DATA
(
)
SP:BEGIN
     DECLARE SQLSTR  VARCHAR(25000);   
     DECLARE P_TIMERANGE     VARCHAR(2);
	 DECLARE P_TIMERANGE01 VARCHAR(2);
	 DECLARE P_TIMERANGE02 VARCHAR(2);
	 DECLARE P_TIMERANGE03 VARCHAR(2);
	 DECLARE P_TIMERANGE04 VARCHAR(2);
	 DECLARE P_TIMERANGE05 VARCHAR(2);
	 DECLARE P_TIMERANGE06 VARCHAR(2);
	 DECLARE P_TIMERANGE07 VARCHAR(2);
	 DECLARE P_TIMERANGE08 VARCHAR(2);
	 DECLARE P_TIMERANGE09 VARCHAR(2);
	 DECLARE P_TIMERANGE10 VARCHAR(2);
	 DECLARE P_TIMERANGE11 VARCHAR(2);
	 DECLARE P_TIMERANGE12 VARCHAR(2);
	 DECLARE P_TIMERANGE13 VARCHAR(2);
	 DECLARE P_TIMERANGE14 VARCHAR(2);
	 DECLARE P_TIMERANGE15 VARCHAR(2);
	 DECLARE P_TIMERANGE16 VARCHAR(2);
	 DECLARE P_TIMERANGE17 VARCHAR(2);
	 DECLARE P_TIMERANGE18 VARCHAR(2);
	 DECLARE P_TIMERANGE19 VARCHAR(2);
	 DECLARE P_TIMERANGE20 VARCHAR(2);
	 DECLARE P_TIMERANGE21 VARCHAR(2);
	 DECLARE P_TIMERANGE22 VARCHAR(2);
	 DECLARE P_TIMERANGE23 VARCHAR(2);
	 DECLARE P_TIMERANGE24 VARCHAR(2);
	 DECLARE P_DAY      INTEGER;
	 DECLARE P_DAY01 INTEGER;
	 DECLARE P_DAY02 INTEGER;
	 DECLARE P_DAY03 INTEGER;
	 DECLARE P_DAY04 INTEGER;
	 DECLARE P_DAY05 INTEGER;
	 DECLARE P_DAY06 INTEGER;
	 DECLARE P_DAY07 INTEGER;
	 DECLARE P_DAY08 INTEGER;
	 DECLARE P_DAY09 INTEGER;
	 DECLARE P_DAY10 INTEGER;
	 DECLARE P_DAY11 INTEGER;
	 DECLARE P_DAY12 INTEGER;
	 DECLARE P_DAY13 INTEGER;
	 DECLARE P_DAY14 INTEGER;
	 DECLARE P_DAY15 INTEGER;
	 DECLARE P_DAY16 INTEGER;
	 DECLARE P_DAY17 INTEGER;
	 DECLARE P_DAY18 INTEGER;
	 DECLARE P_DAY19 INTEGER;
	 DECLARE P_DAY20 INTEGER;
	 DECLARE P_DAY21 INTEGER;
	 DECLARE P_DAY22 INTEGER;
	 DECLARE P_DAY23 INTEGER;
	 DECLARE P_DAY24 INTEGER;
	 DECLARE P_LW_DAY      INTEGER;
	 DECLARE P_LW_DAY01 INTEGER;
	 DECLARE P_LW_DAY02 INTEGER;
	 DECLARE P_LW_DAY03 INTEGER;
	 DECLARE P_LW_DAY04 INTEGER;
	 DECLARE P_LW_DAY05 INTEGER;
	 DECLARE P_LW_DAY06 INTEGER;
	 DECLARE P_LW_DAY07 INTEGER;
	 DECLARE P_LW_DAY08 INTEGER;
	 DECLARE P_LW_DAY09 INTEGER;
	 DECLARE P_LW_DAY10 INTEGER;
	 DECLARE P_LW_DAY11 INTEGER;
	 DECLARE P_LW_DAY12 INTEGER;
	 DECLARE P_LW_DAY13 INTEGER;
	 DECLARE P_LW_DAY14 INTEGER;
	 DECLARE P_LW_DAY15 INTEGER;
	 DECLARE P_LW_DAY16 INTEGER;
	 DECLARE P_LW_DAY17 INTEGER;
	 DECLARE P_LW_DAY18 INTEGER;
	 DECLARE P_LW_DAY19 INTEGER;
	 DECLARE P_LW_DAY20 INTEGER;
	 DECLARE P_LW_DAY21 INTEGER;
	 DECLARE P_LW_DAY22 INTEGER;
	 DECLARE P_LW_DAY23 INTEGER;
	 DECLARE P_LW_DAY24 INTEGER;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '1' HOUR ,'HH24') INTO P_TIMERANGE;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '1' HOUR ,'HH24') INTO P_TIMERANGE01;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '2' HOUR ,'HH24') INTO P_TIMERANGE02;
     SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '3' HOUR ,'HH24') INTO P_TIMERANGE03;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '4' HOUR ,'HH24') INTO P_TIMERANGE04;
     SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '5' HOUR ,'HH24') INTO P_TIMERANGE05;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '6' HOUR ,'HH24') INTO P_TIMERANGE06;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '7' HOUR ,'HH24') INTO P_TIMERANGE07;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '8' HOUR ,'HH24') INTO P_TIMERANGE08;   
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '9' HOUR ,'HH24') INTO P_TIMERANGE09;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '10' HOUR ,'HH24') INTO P_TIMERANGE10;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '11' HOUR ,'HH24') INTO P_TIMERANGE11;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '12' HOUR ,'HH24') INTO P_TIMERANGE12;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '13' HOUR ,'HH24') INTO P_TIMERANGE13;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '14' HOUR ,'HH24') INTO P_TIMERANGE14;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '15' HOUR ,'HH24') INTO P_TIMERANGE15;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '16' HOUR ,'HH24') INTO P_TIMERANGE16;  
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '17' HOUR ,'HH24') INTO P_TIMERANGE17;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '18' HOUR ,'HH24') INTO P_TIMERANGE18;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '19' HOUR ,'HH24') INTO P_TIMERANGE19;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '20' HOUR ,'HH24') INTO P_TIMERANGE20;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '21' HOUR ,'HH24') INTO P_TIMERANGE21;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '22' HOUR ,'HH24') INTO P_TIMERANGE22;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '23' HOUR ,'HH24') INTO P_TIMERANGE23;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '24' HOUR ,'HH24') INTO P_TIMERANGE24;  
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '1' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '2' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY01;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '3' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY02;
     SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '4' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY03;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '5' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY04;
     SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '6' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY05;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '7' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY06;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '8' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY07;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '9' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY08;   
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '10' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY09;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '11' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY10;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '12' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY11;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '13' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY12;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '14' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY13;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '15' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY14;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '16' HOUR ,'YYYYMMDD')  AS INTEGER )INTO P_DAY15;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '17' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY16;  
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '18' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY17;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '19' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY18;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '20' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY19;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '21' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY20;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '22' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY21;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '23' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY22;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '24' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY23;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '25' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY24; 
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '1' HOUR ,'YYYYMMDD')  AS INTEGER)  INTO P_LW_DAY;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '2' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY01;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '3' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY02;
     SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '4' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY03;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '5' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY04;
     SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '6' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY05;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '7' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY06;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '8' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY07;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '9' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY08;   
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '10' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY09;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '11' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY10;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '12' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY11;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '13' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY12;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '14' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY13;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '15' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY14;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '16' HOUR ,'YYYYMMDD')  AS INTEGER )INTO P_LW_DAY15;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '17' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY16;  
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '18' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY17;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '19' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY18;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '20' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY19;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '21' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY20;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '22' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY21;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '23' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY22;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '24' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY23;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '25' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY24; 
	DELETE FROM PMART.TSC_SALES_PRD_WARNING_24H;
	 SET SQLSTR ='INSERT INTO PMART.TSC_SALES_PRD_WARNING_24H(DATA_DAY,DEPT_NO,PRD_ID' +
	                            '  ,TODAY_PRD_SALES00,LASTWEEK_PRD_SALES00,X_HEADER00 '+
								'  ,TODAY_PRD_SALES01,LASTWEEK_PRD_SALES01,X_HEADER01 '+
	                            '  ,TODAY_PRD_SALES02,LASTWEEK_PRD_SALES02,X_HEADER02 '+
	                            '  ,TODAY_PRD_SALES03,LASTWEEK_PRD_SALES03,X_HEADER03 '+
	                            '  ,TODAY_PRD_SALES04,LASTWEEK_PRD_SALES04,X_HEADER04 '+
	                            '  ,TODAY_PRD_SALES05,LASTWEEK_PRD_SALES05,X_HEADER05 '+
	                            '  ,TODAY_PRD_SALES06,LASTWEEK_PRD_SALES06,X_HEADER06 '+								
	                            '  ,TODAY_PRD_SALES07,LASTWEEK_PRD_SALES07,X_HEADER07 '+								
	                            '  ,TODAY_PRD_SALES08,LASTWEEK_PRD_SALES08,X_HEADER08 '+								
	                            '  ,TODAY_PRD_SALES09,LASTWEEK_PRD_SALES09,X_HEADER09 '+								
	                            '  ,TODAY_PRD_SALES10,LASTWEEK_PRD_SALES10,X_HEADER10 '+								
	                            '  ,TODAY_PRD_SALES11,LASTWEEK_PRD_SALES11,X_HEADER11 '+								
	                            '  ,TODAY_PRD_SALES12,LASTWEEK_PRD_SALES12,X_HEADER12 '+								
	                            '  ,TODAY_PRD_SALES13,LASTWEEK_PRD_SALES13,X_HEADER13 '+								
	                            '  ,TODAY_PRD_SALES14,LASTWEEK_PRD_SALES14,X_HEADER14 '+								
	                            '  ,TODAY_PRD_SALES15,LASTWEEK_PRD_SALES15,X_HEADER15 '+								
	                            '  ,TODAY_PRD_SALES16,LASTWEEK_PRD_SALES16,X_HEADER16 '+								
	                            '  ,TODAY_PRD_SALES17,LASTWEEK_PRD_SALES17,X_HEADER17 '+								
	                            '  ,TODAY_PRD_SALES18,LASTWEEK_PRD_SALES18,X_HEADER18 '+								
	                            '  ,TODAY_PRD_SALES19,LASTWEEK_PRD_SALES19,X_HEADER19 '+								
	                            '  ,TODAY_PRD_SALES20,LASTWEEK_PRD_SALES20,X_HEADER20 '+								
	                            '  ,TODAY_PRD_SALES21,LASTWEEK_PRD_SALES21,X_HEADER21 '+								
	                            '  ,TODAY_PRD_SALES22,LASTWEEK_PRD_SALES22,X_HEADER22 '+								
	                            '  ,TODAY_PRD_SALES23,LASTWEEK_PRD_SALES23,X_HEADER23 '+
								')' +
                                'SELECT 	          DATA_DAY,DEPT_NO,PRD_ID '+
                                '                               ,SUM(TODAY_PRD_SALES00),SUM(LASTWEEK_PRD_SALES00),X_HEADER00  '+
                                '                               ,SUM(TODAY_PRD_SALES01),SUM(LASTWEEK_PRD_SALES01),X_HEADER01 '+ 
                                '                               ,SUM(TODAY_PRD_SALES02),SUM(LASTWEEK_PRD_SALES02),X_HEADER02 '+ 
                                '                               ,SUM(TODAY_PRD_SALES03),SUM(LASTWEEK_PRD_SALES03),X_HEADER03 '+ 
                                '                               ,SUM(TODAY_PRD_SALES04),SUM(LASTWEEK_PRD_SALES04),X_HEADER04 '+ 
                                '                               ,SUM(TODAY_PRD_SALES05),SUM(LASTWEEK_PRD_SALES05),X_HEADER05 '+ 
                                '                               ,SUM(TODAY_PRD_SALES06),SUM(LASTWEEK_PRD_SALES06),X_HEADER06 '+ 
                                '                               ,SUM(TODAY_PRD_SALES07),SUM(LASTWEEK_PRD_SALES07),X_HEADER07 '+ 
                                '                               ,SUM(TODAY_PRD_SALES08),SUM(LASTWEEK_PRD_SALES08),X_HEADER08 '+ 
                                '                               ,SUM(TODAY_PRD_SALES09),SUM(LASTWEEK_PRD_SALES09),X_HEADER09 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES10),SUM(LASTWEEK_PRD_SALES10),X_HEADER10 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES11),SUM(LASTWEEK_PRD_SALES11),X_HEADER11 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES12),SUM(LASTWEEK_PRD_SALES12),X_HEADER12 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES13),SUM(LASTWEEK_PRD_SALES13),X_HEADER13 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES14),SUM(LASTWEEK_PRD_SALES14),X_HEADER14 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES15),SUM(LASTWEEK_PRD_SALES15),X_HEADER15 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES16),SUM(LASTWEEK_PRD_SALES16),X_HEADER16 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES17),SUM(LASTWEEK_PRD_SALES17),X_HEADER17 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES18),SUM(LASTWEEK_PRD_SALES18),X_HEADER18 '+ 						
                                '                               ,SUM(TODAY_PRD_SALES19),SUM(LASTWEEK_PRD_SALES19),X_HEADER19 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES20),SUM(LASTWEEK_PRD_SALES20),X_HEADER20 '+ 							
                                '                               ,SUM(TODAY_PRD_SALES21),SUM(LASTWEEK_PRD_SALES21),X_HEADER21 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES22),SUM(LASTWEEK_PRD_SALES22),X_HEADER22 '+ 								
                                '                               ,SUM(TODAY_PRD_SALES23),SUM(LASTWEEK_PRD_SALES23),X_HEADER23 '+ 								  
                                'FROM ( '+
                                'SELECT  CAST(TO_CHAR(CURRENT_DATE,''YYYYMMDD'')AS INTEGER)  AS DATA_DAY,' +
                                '                    DATA.DEPT_NO,' +
								'                    DATA.PRD_ID,'+
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY24 +'THEN SALES'+P_TIMERANGE24 +' ELSE 0 END) AS TODAY_PRD_SALES00,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY24 +'THEN SALES'+P_TIMERANGE24 +' ELSE 0 END) AS LASTWEEK_PRD_SALES00,' +
                                '                    CAST( '''+P_TIMERANGE24+''' AS VARCHAR(2)) AS X_HEADER00,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY23 +'THEN SALES'+P_TIMERANGE23 +' ELSE 0 END) AS TODAY_PRD_SALES01,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY23 +'THEN SALES'+P_TIMERANGE23 +' ELSE 0 END) AS LASTWEEK_PRD_SALES01,' +
                                '                    CAST( '''+P_TIMERANGE23+''' AS VARCHAR(2)) AS X_HEADER01,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY22 +'THEN SALES'+P_TIMERANGE22 +' ELSE 0 END) AS TODAY_PRD_SALES02,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY22 +'THEN SALES'+P_TIMERANGE22 +' ELSE 0 END) AS LASTWEEK_PRD_SALES02,' +
                                '                    CAST( '''+P_TIMERANGE22+''' AS VARCHAR(2)) AS X_HEADER02,' +			
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY21 +'THEN SALES'+P_TIMERANGE21 +' ELSE 0 END) AS TODAY_PRD_SALES03,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY21 +'THEN SALES'+P_TIMERANGE21 +' ELSE 0 END) AS LASTWEEK_PRD_SALES03,' +
                                '                    CAST( '''+P_TIMERANGE21+''' AS VARCHAR(2)) AS X_HEADER03,' +		
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY20 +'THEN SALES'+P_TIMERANGE20 +' ELSE 0 END) AS TODAY_PRD_SALES04,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY20 +'THEN SALES'+P_TIMERANGE20 +' ELSE 0 END) AS LASTWEEK_PRD_SALES04,' +
                                '                    CAST( '''+P_TIMERANGE20+''' AS VARCHAR(2)) AS X_HEADER04,' +			
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY19 +'THEN SALES'+P_TIMERANGE19 +' ELSE 0 END) AS TODAY_PRD_SALES05,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY19 +'THEN SALES'+P_TIMERANGE19 +' ELSE 0 END) AS LASTWEEK_PRD_SALES05,' +
                                '                    CAST( '''+P_TIMERANGE19+''' AS VARCHAR(2)) AS X_HEADER05,' +								
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY18 +'THEN SALES'+P_TIMERANGE18 +' ELSE 0 END) AS TODAY_PRD_SALES06,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY18 +'THEN SALES'+P_TIMERANGE18 +' ELSE 0 END) AS LASTWEEK_PRD_SALES06,' +
                                '                    CAST( '''+P_TIMERANGE18+''' AS VARCHAR(2)) AS X_HEADER06,' +					
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY17 +'THEN SALES'+P_TIMERANGE17 +' ELSE 0 END) AS TODAY_PRD_SALES07,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY17 +'THEN SALES'+P_TIMERANGE17 +' ELSE 0 END) AS LASTWEEK_PRD_SALES07,' +
                                '                    CAST( '''+P_TIMERANGE17+''' AS VARCHAR(2)) AS X_HEADER07,' +							
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY16 +'THEN SALES'+P_TIMERANGE16 +' ELSE 0 END) AS TODAY_PRD_SALES08,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY16 +'THEN SALES'+P_TIMERANGE16 +' ELSE 0 END) AS LASTWEEK_PRD_SALES08,' +
                                '                    CAST( '''+P_TIMERANGE16+''' AS VARCHAR(2)) AS X_HEADER08,' +								
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY15 +'THEN SALES'+P_TIMERANGE15 +' ELSE 0 END) AS TODAY_PRD_SALES09,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY15 +'THEN SALES'+P_TIMERANGE15 +' ELSE 0 END) AS LASTWEEK_PRD_SALES09,' +
                                '                    CAST( '''+P_TIMERANGE15+''' AS VARCHAR(2)) AS X_HEADER09,' +							
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY14 +'THEN SALES'+P_TIMERANGE14 +' ELSE 0 END) AS TODAY_PRD_SALES10,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY14 +'THEN SALES'+P_TIMERANGE14 +' ELSE 0 END) AS LASTWEEK_PRD_SALES10,' +
                                '                    CAST( '''+P_TIMERANGE14+''' AS VARCHAR(2)) AS X_HEADER10,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY13 +'THEN SALES'+P_TIMERANGE13 +' ELSE 0 END) AS TODAY_PRD_SALES11,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY13 +'THEN SALES'+P_TIMERANGE13 +' ELSE 0 END) AS LASTWEEK_PRD_SALES11,' +
                                '                    CAST( '''+P_TIMERANGE13+''' AS VARCHAR(2)) AS X_HEADER11,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY12 +'THEN SALES'+P_TIMERANGE12 +' ELSE 0 END) AS TODAY_PRD_SALES12,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY12 +'THEN SALES'+P_TIMERANGE12 +' ELSE 0 END) AS LASTWEEK_PRD_SALES12,' +
                                '                    CAST( '''+P_TIMERANGE12+''' AS VARCHAR(2)) AS X_HEADER12,' +			
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY11 +'THEN SALES'+P_TIMERANGE11 +' ELSE 0 END) AS TODAY_PRD_SALES13,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY11 +'THEN SALES'+P_TIMERANGE11 +' ELSE 0 END) AS LASTWEEK_PRD_SALES13,' +
                                '                    CAST( '''+P_TIMERANGE11+''' AS VARCHAR(2)) AS X_HEADER13,' +		
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY10 +'THEN SALES'+P_TIMERANGE10 +' ELSE 0 END) AS TODAY_PRD_SALES14,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY10 +'THEN SALES'+P_TIMERANGE10 +' ELSE 0 END) AS LASTWEEK_PRD_SALES14,' +
                                '                    CAST( '''+P_TIMERANGE10+''' AS VARCHAR(2)) AS X_HEADER14,' +			
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY09 +'THEN SALES'+P_TIMERANGE09 +' ELSE 0 END) AS TODAY_PRD_SALES15,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY09 +'THEN SALES'+P_TIMERANGE09 +' ELSE 0 END) AS LASTWEEK_PRD_SALES15,' +
                                '                    CAST( '''+P_TIMERANGE09+''' AS VARCHAR(2)) AS X_HEADER15,' +								
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY08 +'THEN SALES'+P_TIMERANGE08 +' ELSE 0 END) AS TODAY_PRD_SALES16,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY08 +'THEN SALES'+P_TIMERANGE08 +' ELSE 0 END) AS LASTWEEK_PRD_SALES16,' +
                                '                    CAST( '''+P_TIMERANGE08+''' AS VARCHAR(2)) AS X_HEADER16,' +					
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY07 +'THEN SALES'+P_TIMERANGE07 +' ELSE 0 END) AS TODAY_PRD_SALES17,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY07 +'THEN SALES'+P_TIMERANGE07 +' ELSE 0 END) AS LASTWEEK_PRD_SALES17,' +
                                '                    CAST( '''+P_TIMERANGE07+''' AS VARCHAR(2)) AS X_HEADER17,' +							
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY06 +'THEN SALES'+P_TIMERANGE06 +' ELSE 0 END) AS TODAY_PRD_SALES18,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY06 +'THEN SALES'+P_TIMERANGE06 +' ELSE 0 END) AS LASTWEEK_PRD_SALES18,' +
                                '                    CAST( '''+P_TIMERANGE06+''' AS VARCHAR(2)) AS X_HEADER18,' +								
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY05 +'THEN SALES'+P_TIMERANGE05 +' ELSE 0 END) AS TODAY_PRD_SALES19,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY05 +'THEN SALES'+P_TIMERANGE05 +' ELSE 0 END) AS LASTWEEK_PRD_SALES19,' +
                                '                    CAST( '''+P_TIMERANGE05+''' AS VARCHAR(2)) AS X_HEADER19,' +	
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY04 +'THEN SALES'+P_TIMERANGE04 +' ELSE 0 END) AS TODAY_PRD_SALES20,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY04 +'THEN SALES'+P_TIMERANGE04 +' ELSE 0 END) AS LASTWEEK_PRD_SALES20,' +
                                '                    CAST( '''+P_TIMERANGE04+''' AS VARCHAR(2)) AS X_HEADER20,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY03 +'THEN SALES'+P_TIMERANGE03 +' ELSE 0 END) AS TODAY_PRD_SALES21,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY03 +'THEN SALES'+P_TIMERANGE03 +' ELSE 0 END) AS LASTWEEK_PRD_SALES21,' +
                                '                    CAST( '''+P_TIMERANGE03+''' AS VARCHAR(2)) AS X_HEADER21,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY02 +'THEN SALES'+P_TIMERANGE02 +' ELSE 0 END) AS TODAY_PRD_SALES22,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY02 +'THEN SALES'+P_TIMERANGE02 +' ELSE 0 END) AS LASTWEEK_PRD_SALES22,' +
                                '                    CAST( '''+P_TIMERANGE02+''' AS VARCHAR(2)) AS X_HEADER22,' +			
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_DAY01 +'THEN SALES'+P_TIMERANGE01 +' ELSE 0 END) AS TODAY_PRD_SALES23,' +
                                '                    SUM(CASE WHEN  DATA.DAY_ID='+P_LW_DAY01 +'THEN SALES'+P_TIMERANGE01 +' ELSE 0 END) AS LASTWEEK_PRD_SALES23,' +
                                '                    CAST( '''+P_TIMERANGE01+''' AS VARCHAR(2)) AS X_HEADER23' +									
                                '   FROM PMART.TSC_SALES_PRD_WARNING_DEPT AS  DATA' +
								' WHERE (DATA.DAY_ID = '+P_DAY24 +
	       			            '                    OR DATA.DAY_ID = '+P_LW_DAY24+
								'                    OR DATA.DAY_ID = '+P_DAY+
								'                    OR DATA.DAY_ID = '+P_LW_DAY+
				                '                   ) ' +
                                'GROUP BY   DATA.DAY_ID,DATA.DEPT_NO,DATA.PRD_ID ' +
								') DAT ' +
                                'GROUP BY DATA_DAY,DEPT_NO,PRD_ID,X_HEADER00,X_HEADER01,X_HEADER02 ' +
                                ',X_HEADER03,X_HEADER04,X_HEADER05,X_HEADER06,X_HEADER07 ' +
                                ',X_HEADER08,X_HEADER09,X_HEADER10,X_HEADER11,X_HEADER12 ' +
                                ',X_HEADER13,X_HEADER14,X_HEADER15,X_HEADER16,X_HEADER17 ' +
                                ',X_HEADER18,X_HEADER19,X_HEADER20,X_HEADER21,X_HEADER22 ' +
                                ',X_HEADER23 ';
	 INSERT INTO PMART.T1 SELECT 1,SQLSTR;
	 EXECUTE IMMEDIATE SQLSTR;   
END SP;