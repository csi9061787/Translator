REPLACE PROCEDURE PMART.REMD_T4_SAGE_FUNC(P_DAY_ID NUMBER, P_ORG_ID NUMBER)
SQL SECURITY INVOKER
SP:BEGIN
DECLARE SQLSTR  VARCHAR(4000) DEFAULT ''; 
  CALL PMART.P_DROP_TABLE ('#VT_REMD_T4_SAGE_FUNC'); 
      SET SQLSTR = 
          'CREATE MULTISET VOLATILE TABLE #VT_REMD_T4_SAGE_FUNC AS('+ 
               'SELECT '+
               'B.STYPE_ID AS STYPE_ID, '+
               'BIT_EXTRACT(BIT_AND(A.MAST_STORE_NUM,B.MASK)) AS MAST_STORE_NUM '+
               'FROM PMART.BASIC_OST_FACT A, PMART.SAGE_MASK B '+
               'WHERE B.ORG_ID='+P_ORG_ID+' '+
               'AND A.TIME_ID='+P_DAY_ID+
          ') WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;';
    EXECUTE IMMEDIATE SQLSTR; 
END SP;