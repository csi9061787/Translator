REPLACE  PROCEDURE PMART.FUNC_TSC_SALES_HOUR_DATA
(
)
SP:BEGIN
     DECLARE SQLSTR  VARCHAR(25000);   
     DECLARE P_TIMERANGE     VARCHAR(2);
	 DECLARE P_TIMERANGE01 VARCHAR(2);
	 DECLARE P_TIMERANGE02 VARCHAR(2);
	 DECLARE P_TIMERANGE03 VARCHAR(2);
	 DECLARE P_TIMERANGE04 VARCHAR(2);
	 DECLARE P_TIMERANGE05 VARCHAR(2);
	 DECLARE P_TIMERANGE06 VARCHAR(2);
	 DECLARE P_TIMERANGE07 VARCHAR(2);
	 DECLARE P_TIMERANGE08 VARCHAR(2);
	 DECLARE P_TIMERANGE09 VARCHAR(2);
	 DECLARE P_TIMERANGE10 VARCHAR(2);
	 DECLARE P_TIMERANGE11 VARCHAR(2);
	 DECLARE P_TIMERANGE12 VARCHAR(2);
	 DECLARE P_TIMERANGE13 VARCHAR(2);
	 DECLARE P_TIMERANGE14 VARCHAR(2);
	 DECLARE P_TIMERANGE15 VARCHAR(2);
	 DECLARE P_TIMERANGE16 VARCHAR(2);
	 DECLARE P_TIMERANGE17 VARCHAR(2);
	 DECLARE P_TIMERANGE18 VARCHAR(2);
	 DECLARE P_TIMERANGE19 VARCHAR(2);
	 DECLARE P_TIMERANGE20 VARCHAR(2);
	 DECLARE P_TIMERANGE21 VARCHAR(2);
	 DECLARE P_TIMERANGE22 VARCHAR(2);
	 DECLARE P_TIMERANGE23 VARCHAR(2);
	 DECLARE P_TIMERANGE24 VARCHAR(2);
	 DECLARE P_DAY      INTEGER;
	 DECLARE P_DAY01 INTEGER;
	 DECLARE P_DAY02 INTEGER;
	 DECLARE P_DAY03 INTEGER;
	 DECLARE P_DAY04 INTEGER;
	 DECLARE P_DAY05 INTEGER;
	 DECLARE P_DAY06 INTEGER;
	 DECLARE P_DAY07 INTEGER;
	 DECLARE P_DAY08 INTEGER;
	 DECLARE P_DAY09 INTEGER;
	 DECLARE P_DAY10 INTEGER;
	 DECLARE P_DAY11 INTEGER;
	 DECLARE P_DAY12 INTEGER;
	 DECLARE P_DAY13 INTEGER;
	 DECLARE P_DAY14 INTEGER;
	 DECLARE P_DAY15 INTEGER;
	 DECLARE P_DAY16 INTEGER;
	 DECLARE P_DAY17 INTEGER;
	 DECLARE P_DAY18 INTEGER;
	 DECLARE P_DAY19 INTEGER;
	 DECLARE P_DAY20 INTEGER;
	 DECLARE P_DAY21 INTEGER;
	 DECLARE P_DAY22 INTEGER;
	 DECLARE P_DAY23 INTEGER;
	 DECLARE P_DAY24 INTEGER;
	 DECLARE P_LW_DAY      INTEGER;
	 DECLARE P_LW_DAY01 INTEGER;
	 DECLARE P_LW_DAY02 INTEGER;
	 DECLARE P_LW_DAY03 INTEGER;
	 DECLARE P_LW_DAY04 INTEGER;
	 DECLARE P_LW_DAY05 INTEGER;
	 DECLARE P_LW_DAY06 INTEGER;
	 DECLARE P_LW_DAY07 INTEGER;
	 DECLARE P_LW_DAY08 INTEGER;
	 DECLARE P_LW_DAY09 INTEGER;
	 DECLARE P_LW_DAY10 INTEGER;
	 DECLARE P_LW_DAY11 INTEGER;
	 DECLARE P_LW_DAY12 INTEGER;
	 DECLARE P_LW_DAY13 INTEGER;
	 DECLARE P_LW_DAY14 INTEGER;
	 DECLARE P_LW_DAY15 INTEGER;
	 DECLARE P_LW_DAY16 INTEGER;
	 DECLARE P_LW_DAY17 INTEGER;
	 DECLARE P_LW_DAY18 INTEGER;
	 DECLARE P_LW_DAY19 INTEGER;
	 DECLARE P_LW_DAY20 INTEGER;
	 DECLARE P_LW_DAY21 INTEGER;
	 DECLARE P_LW_DAY22 INTEGER;
	 DECLARE P_LW_DAY23 INTEGER;
	 DECLARE P_LW_DAY24 INTEGER;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '1' HOUR ,'HH24') INTO P_TIMERANGE;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '1' HOUR ,'HH24') INTO P_TIMERANGE01;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '2' HOUR ,'HH24') INTO P_TIMERANGE02;
     SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '3' HOUR ,'HH24') INTO P_TIMERANGE03;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '4' HOUR ,'HH24') INTO P_TIMERANGE04;
     SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '5' HOUR ,'HH24') INTO P_TIMERANGE05;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '6' HOUR ,'HH24') INTO P_TIMERANGE06;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '7' HOUR ,'HH24') INTO P_TIMERANGE07;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '8' HOUR ,'HH24') INTO P_TIMERANGE08;   
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '9' HOUR ,'HH24') INTO P_TIMERANGE09;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '10' HOUR ,'HH24') INTO P_TIMERANGE10;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '11' HOUR ,'HH24') INTO P_TIMERANGE11;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '12' HOUR ,'HH24') INTO P_TIMERANGE12;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '13' HOUR ,'HH24') INTO P_TIMERANGE13;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '14' HOUR ,'HH24') INTO P_TIMERANGE14;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '15' HOUR ,'HH24') INTO P_TIMERANGE15;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '16' HOUR ,'HH24') INTO P_TIMERANGE16;  
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '17' HOUR ,'HH24') INTO P_TIMERANGE17;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '18' HOUR ,'HH24') INTO P_TIMERANGE18;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '19' HOUR ,'HH24') INTO P_TIMERANGE19;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '20' HOUR ,'HH24') INTO P_TIMERANGE20;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '21' HOUR ,'HH24') INTO P_TIMERANGE21;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '22' HOUR ,'HH24') INTO P_TIMERANGE22;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '23' HOUR ,'HH24') INTO P_TIMERANGE23;
	 SELECT TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '24' HOUR ,'HH24') INTO P_TIMERANGE24;  
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '1' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '2' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY01;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '3' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY02;
     SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '4' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY03;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '5' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY04;
     SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '6' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY05;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '7' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY06;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '8' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY07;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '9' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY08;   
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '10' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY09;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '11' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY10;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '12' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY11;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '13' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY12;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '14' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY13;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '15' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY14;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '16' HOUR ,'YYYYMMDD')  AS INTEGER )INTO P_DAY15;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '17' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY16;  
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '18' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY17;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '19' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY18;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '20' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY19;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '21' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY20;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '22' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY21;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '23' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY22;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '24' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY23;
	 SELECT CAST(TO_CHAR(CURRENT_TIMESTAMP - INTERVAL '25' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_DAY24; 
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '1' HOUR ,'YYYYMMDD')  AS INTEGER)  INTO P_LW_DAY;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '2' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY01;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '3' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY02;
     SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '4' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY03;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '5' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY04;
     SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '6' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY05;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '7' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY06;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '8' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY07;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '9' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY08;   
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '10' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY09;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '11' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY10;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '12' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY11;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '13' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY12;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '14' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY13;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '15' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY14;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '16' HOUR ,'YYYYMMDD')  AS INTEGER )INTO P_LW_DAY15;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '17' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY16;  
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '18' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY17;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '19' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY18;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '20' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY19;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '21' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY20;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '22' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY21;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '23' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY22;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '24' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY23;
	 SELECT CAST(TO_CHAR((CURRENT_TIMESTAMP - INTERVAL '7' DAY) - INTERVAL '25' HOUR ,'YYYYMMDD')  AS INTEGER) INTO P_LW_DAY24; 
	DELETE FROM PMART.TSC_SALES_DAY_24H;
	DELETE FROM PMART.TSC_SALES_DAY_8H;
	 SET SQLSTR ='INSERT INTO PMART.TSC_SALES_DAY_24H(DATA_DAY,DEPT_ID,DEPT_NAME' +
	                            '  ,TODAY_SALES00,LASTWEEK_SALES00,TODAY_CNT00,LASTWEEK_CNT00,LASTWEEK_SALES_AMT00,LASTWEEK_SALES_CNT00,X_HEADER00 '+
								 '  ,TODAY_SALES01,LASTWEEK_SALES01,TODAY_CNT01,LASTWEEK_CNT01,LASTWEEK_SALES_AMT01,LASTWEEK_SALES_CNT01,X_HEADER01 '+
								 '  ,TODAY_SALES02,LASTWEEK_SALES02,TODAY_CNT02,LASTWEEK_CNT02,LASTWEEK_SALES_AMT02,LASTWEEK_SALES_CNT02,X_HEADER02 '+
								 '  ,TODAY_SALES03,LASTWEEK_SALES03,TODAY_CNT03,LASTWEEK_CNT03,LASTWEEK_SALES_AMT03,LASTWEEK_SALES_CNT03,X_HEADER03 '+
								 '  ,TODAY_SALES04,LASTWEEK_SALES04,TODAY_CNT04,LASTWEEK_CNT04,LASTWEEK_SALES_AMT04,LASTWEEK_SALES_CNT04,X_HEADER04 '+
								 '  ,TODAY_SALES05,LASTWEEK_SALES05,TODAY_CNT05,LASTWEEK_CNT05,LASTWEEK_SALES_AMT05,LASTWEEK_SALES_CNT05,X_HEADER05 '+
								 '  ,TODAY_SALES06,LASTWEEK_SALES06,TODAY_CNT06,LASTWEEK_CNT06,LASTWEEK_SALES_AMT06,LASTWEEK_SALES_CNT06,X_HEADER06 '+
								 '  ,TODAY_SALES07,LASTWEEK_SALES07,TODAY_CNT07,LASTWEEK_CNT07,LASTWEEK_SALES_AMT07,LASTWEEK_SALES_CNT07,X_HEADER07 '+
								 '  ,TODAY_SALES08,LASTWEEK_SALES08,TODAY_CNT08,LASTWEEK_CNT08,LASTWEEK_SALES_AMT08,LASTWEEK_SALES_CNT08,X_HEADER08 '+
								'  ,TODAY_SALES09,LASTWEEK_SALES09,TODAY_CNT09,LASTWEEK_CNT09,LASTWEEK_SALES_AMT09,LASTWEEK_SALES_CNT09,X_HEADER09 '+
								'  ,TODAY_SALES10,LASTWEEK_SALES10,TODAY_CNT10,LASTWEEK_CNT10,LASTWEEK_SALES_AMT10,LASTWEEK_SALES_CNT10,X_HEADER10 '+
								 '  ,TODAY_SALES11,LASTWEEK_SALES11,TODAY_CNT11,LASTWEEK_CNT11,LASTWEEK_SALES_AMT11,LASTWEEK_SALES_CNT11,X_HEADER11 '+
								 '  ,TODAY_SALES12,LASTWEEK_SALES12,TODAY_CNT12,LASTWEEK_CNT12,LASTWEEK_SALES_AMT12,LASTWEEK_SALES_CNT12,X_HEADER12 '+
								 '  ,TODAY_SALES13,LASTWEEK_SALES13,TODAY_CNT13,LASTWEEK_CNT13,LASTWEEK_SALES_AMT13,LASTWEEK_SALES_CNT13,X_HEADER13 '+
								 '  ,TODAY_SALES14,LASTWEEK_SALES14,TODAY_CNT14,LASTWEEK_CNT14,LASTWEEK_SALES_AMT14,LASTWEEK_SALES_CNT14,X_HEADER14 '+
								 '  ,TODAY_SALES15,LASTWEEK_SALES15,TODAY_CNT15,LASTWEEK_CNT15,LASTWEEK_SALES_AMT15,LASTWEEK_SALES_CNT15,X_HEADER15 '+
								 '  ,TODAY_SALES16,LASTWEEK_SALES16,TODAY_CNT16,LASTWEEK_CNT16,LASTWEEK_SALES_AMT16,LASTWEEK_SALES_CNT16,X_HEADER16 '+
								 '  ,TODAY_SALES17,LASTWEEK_SALES17,TODAY_CNT17,LASTWEEK_CNT17,LASTWEEK_SALES_AMT17,LASTWEEK_SALES_CNT17,X_HEADER17 '+
								 '  ,TODAY_SALES18,LASTWEEK_SALES18,TODAY_CNT18,LASTWEEK_CNT18,LASTWEEK_SALES_AMT18,LASTWEEK_SALES_CNT18,X_HEADER18 '+
								 '  ,TODAY_SALES19,LASTWEEK_SALES19,TODAY_CNT19,LASTWEEK_CNT19,LASTWEEK_SALES_AMT19,LASTWEEK_SALES_CNT19,X_HEADER19 '+
								 '  ,TODAY_SALES20,LASTWEEK_SALES20,TODAY_CNT20,LASTWEEK_CNT20,LASTWEEK_SALES_AMT20,LASTWEEK_SALES_CNT20,X_HEADER20 '+
								 '  ,TODAY_SALES21,LASTWEEK_SALES21,TODAY_CNT21,LASTWEEK_CNT21,LASTWEEK_SALES_AMT21,LASTWEEK_SALES_CNT21,X_HEADER21 '+
								 '  ,TODAY_SALES22,LASTWEEK_SALES22,TODAY_CNT22,LASTWEEK_CNT22,LASTWEEK_SALES_AMT22,LASTWEEK_SALES_CNT22,X_HEADER22 '+
								 '  ,TODAY_SALES23,LASTWEEK_SALES23,TODAY_CNT23,LASTWEEK_CNT23,LASTWEEK_SALES_AMT23,LASTWEEK_SALES_CNT23,X_HEADER23 '+
								')' +
                                'SELECT  CAST(TO_CHAR(CURRENT_DATE,''YYYYMMDD'')AS INTEGER)  AS DATA_DAY,' +
                                '                    D.DEPT_ID,' +
                                '                    D.DEPT_NAME,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY24 +'THEN SALES'+P_TIMERANGE24 +' ELSE 0 END) AS TODAY_SALES00,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY24 +'THEN SALES'+P_TIMERANGE24 +' ELSE 0 END) AS LASTWEEK_SALES00,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY24 +'THEN SALES'+P_TIMERANGE24 +' ELSE 0 END) AS TODAY_CNT00,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY24 +'THEN SALES'+P_TIMERANGE24 +' ELSE 0 END) AS LASTWEEK_CNT00,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT00,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT00,' +
                                '                    CAST( '''+P_TIMERANGE24+''' AS VARCHAR(2)) AS X_HEADER00,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY23 +'THEN SALES'+P_TIMERANGE23 +' ELSE 0 END) AS TODAY_SALES01,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY23 +'THEN SALES'+P_TIMERANGE23 +' ELSE 0 END) AS LASTWEEK_SALES01,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY23 +'THEN SALES'+P_TIMERANGE23 +' ELSE 0 END) AS TODAY_CNT01,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY23 +'THEN SALES'+P_TIMERANGE23 +' ELSE 0 END) AS LASTWEEK_CNT01,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT01,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT01,' +
                                '                    CAST( '''+P_TIMERANGE23+''' AS VARCHAR(2)) AS X_HEADER01,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY22 +'THEN SALES'+P_TIMERANGE22 +' ELSE 0 END) AS TODAY_SALES02,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY22 +'THEN SALES'+P_TIMERANGE22 +' ELSE 0 END) AS LASTWEEK_SALES02,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY22 +'THEN SALES'+P_TIMERANGE22 +' ELSE 0 END) AS TODAY_CNT02,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY22 +'THEN SALES'+P_TIMERANGE22 +' ELSE 0 END) AS LASTWEEK_CNT02,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT02,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT02,' +
                                '                    CAST( '''+P_TIMERANGE22+''' AS VARCHAR(2)) AS X_HEADER02,' +			
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY21 +'THEN SALES'+P_TIMERANGE21 +' ELSE 0 END) AS TODAY_SALES03,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY21 +'THEN SALES'+P_TIMERANGE21 +' ELSE 0 END) AS LASTWEEK_SALES03,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY21 +'THEN SALES'+P_TIMERANGE21 +' ELSE 0 END) AS TODAY_CNT03,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY21 +'THEN SALES'+P_TIMERANGE21 +' ELSE 0 END) AS LASTWEEK_CNT03,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT03,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT03,' +
                                '                    CAST( '''+P_TIMERANGE21+''' AS VARCHAR(2)) AS X_HEADER03,' +		
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY20 +'THEN SALES'+P_TIMERANGE20 +' ELSE 0 END) AS TODAY_SALES04,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY20 +'THEN SALES'+P_TIMERANGE20 +' ELSE 0 END) AS LASTWEEK_SALES04,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY20 +'THEN SALES'+P_TIMERANGE20 +' ELSE 0 END) AS TODAY_CNT04,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY20 +'THEN SALES'+P_TIMERANGE20 +' ELSE 0 END) AS LASTWEEK_CNT04,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT04,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT04,' +
                                '                    CAST( '''+P_TIMERANGE20+''' AS VARCHAR(2)) AS X_HEADER04,' +			
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY19 +'THEN SALES'+P_TIMERANGE19 +' ELSE 0 END) AS TODAY_SALES05,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY19 +'THEN SALES'+P_TIMERANGE19 +' ELSE 0 END) AS LASTWEEK_SALES05,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY19 +'THEN SALES'+P_TIMERANGE19 +' ELSE 0 END) AS TODAY_CNT05,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY19 +'THEN SALES'+P_TIMERANGE19 +' ELSE 0 END) AS LASTWEEK_CNT05,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT05,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT05,' +
                                '                    CAST( '''+P_TIMERANGE19+''' AS VARCHAR(2)) AS X_HEADER05,' +								
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY18 +'THEN SALES'+P_TIMERANGE18 +' ELSE 0 END) AS TODAY_SALES06,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY18 +'THEN SALES'+P_TIMERANGE18 +' ELSE 0 END) AS LASTWEEK_SALES06,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY18 +'THEN SALES'+P_TIMERANGE18 +' ELSE 0 END) AS TODAY_CNT06,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY18 +'THEN SALES'+P_TIMERANGE18 +' ELSE 0 END) AS LASTWEEK_CNT06,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT06,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT06,' +
                                '                    CAST( '''+P_TIMERANGE18+''' AS VARCHAR(2)) AS X_HEADER06,' +					
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY17 +'THEN SALES'+P_TIMERANGE17 +' ELSE 0 END) AS TODAY_SALES07,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY17 +'THEN SALES'+P_TIMERANGE17 +' ELSE 0 END) AS LASTWEEK_SALES07,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY17 +'THEN SALES'+P_TIMERANGE17 +' ELSE 0 END) AS TODAY_CNT07,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY17 +'THEN SALES'+P_TIMERANGE17 +' ELSE 0 END) AS LASTWEEK_CNT07,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT07,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT07,' +
                                '                    CAST( '''+P_TIMERANGE17+''' AS VARCHAR(2)) AS X_HEADER07,' +							
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY16 +'THEN SALES'+P_TIMERANGE16 +' ELSE 0 END) AS TODAY_SALES08,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY16 +'THEN SALES'+P_TIMERANGE16 +' ELSE 0 END) AS LASTWEEK_SALES08,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY16 +'THEN SALES'+P_TIMERANGE16 +' ELSE 0 END) AS TODAY_CNT08,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY16 +'THEN SALES'+P_TIMERANGE16 +' ELSE 0 END) AS LASTWEEK_CNT08,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT08,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT08,' +
                                '                    CAST( '''+P_TIMERANGE16+''' AS VARCHAR(2)) AS X_HEADER08,' +								
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY15 +'THEN SALES'+P_TIMERANGE15 +' ELSE 0 END) AS TODAY_SALES09,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY15 +'THEN SALES'+P_TIMERANGE15 +' ELSE 0 END) AS LASTWEEK_SALES09,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY15 +'THEN SALES'+P_TIMERANGE15 +' ELSE 0 END) AS TODAY_CNT09,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY15 +'THEN SALES'+P_TIMERANGE15 +' ELSE 0 END) AS LASTWEEK_CNT09,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT09,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT09,' +
                                '                    CAST( '''+P_TIMERANGE15+''' AS VARCHAR(2)) AS X_HEADER09,' +							
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY14 +'THEN SALES'+P_TIMERANGE14 +' ELSE 0 END) AS TODAY_SALES10,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY14 +'THEN SALES'+P_TIMERANGE14 +' ELSE 0 END) AS LASTWEEK_SALES10,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY14 +'THEN SALES'+P_TIMERANGE14 +' ELSE 0 END) AS TODAY_CNT10,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY14 +'THEN SALES'+P_TIMERANGE14 +' ELSE 0 END) AS LASTWEEK_CNT10,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT10,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT10,' +
                                '                    CAST( '''+P_TIMERANGE14+''' AS VARCHAR(2)) AS X_HEADER10,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY13 +'THEN SALES'+P_TIMERANGE13 +' ELSE 0 END) AS TODAY_SALES11,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY13 +'THEN SALES'+P_TIMERANGE13 +' ELSE 0 END) AS LASTWEEK_SALES11,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY13 +'THEN SALES'+P_TIMERANGE13 +' ELSE 0 END) AS TODAY_CNT11,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY13 +'THEN SALES'+P_TIMERANGE13 +' ELSE 0 END) AS LASTWEEK_CNT11,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT11,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT11,' +
                                '                    CAST( '''+P_TIMERANGE13+''' AS VARCHAR(2)) AS X_HEADER11,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY12 +'THEN SALES'+P_TIMERANGE12 +' ELSE 0 END) AS TODAY_SALES12,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY12 +'THEN SALES'+P_TIMERANGE12 +' ELSE 0 END) AS LASTWEEK_SALES12,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY12 +'THEN SALES'+P_TIMERANGE12 +' ELSE 0 END) AS TODAY_CNT12,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY12 +'THEN SALES'+P_TIMERANGE12 +' ELSE 0 END) AS LASTWEEK_CNT12,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT12,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT12,' +
                                '                    CAST( '''+P_TIMERANGE12+''' AS VARCHAR(2)) AS X_HEADER12,' +			
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY11 +'THEN SALES'+P_TIMERANGE11 +' ELSE 0 END) AS TODAY_SALES13,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY11 +'THEN SALES'+P_TIMERANGE11 +' ELSE 0 END) AS LASTWEEK_SALES13,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY11 +'THEN SALES'+P_TIMERANGE11 +' ELSE 0 END) AS TODAY_CNT13,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY11 +'THEN SALES'+P_TIMERANGE11 +' ELSE 0 END) AS LASTWEEK_CNT13,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT13,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT13,' +
                                '                    CAST( '''+P_TIMERANGE11+''' AS VARCHAR(2)) AS X_HEADER13,' +		
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY10 +'THEN SALES'+P_TIMERANGE10 +' ELSE 0 END) AS TODAY_SALES14,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY10 +'THEN SALES'+P_TIMERANGE10 +' ELSE 0 END) AS LASTWEEK_SALES14,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY10 +'THEN SALES'+P_TIMERANGE10 +' ELSE 0 END) AS TODAY_CNT14,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY10 +'THEN SALES'+P_TIMERANGE10 +' ELSE 0 END) AS LASTWEEK_CNT14,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT14,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT14,' +
                                '                    CAST( '''+P_TIMERANGE10+''' AS VARCHAR(2)) AS X_HEADER14,' +			
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY09 +'THEN SALES'+P_TIMERANGE09 +' ELSE 0 END) AS TODAY_SALES15,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY09 +'THEN SALES'+P_TIMERANGE09 +' ELSE 0 END) AS LASTWEEK_SALES15,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY09 +'THEN SALES'+P_TIMERANGE09 +' ELSE 0 END) AS TODAY_CNT15,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY09 +'THEN SALES'+P_TIMERANGE09 +' ELSE 0 END) AS LASTWEEK_CNT15,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT15,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT15,' +
                                '                    CAST( '''+P_TIMERANGE09+''' AS VARCHAR(2)) AS X_HEADER15,' +								
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY08 +'THEN SALES'+P_TIMERANGE08 +' ELSE 0 END) AS TODAY_SALES16,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY08 +'THEN SALES'+P_TIMERANGE08 +' ELSE 0 END) AS LASTWEEK_SALES16,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY08 +'THEN SALES'+P_TIMERANGE08 +' ELSE 0 END) AS TODAY_CNT16,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY08 +'THEN SALES'+P_TIMERANGE08 +' ELSE 0 END) AS LASTWEEK_CNT16,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT16,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT16,' +
                                '                    CAST( '''+P_TIMERANGE08+''' AS VARCHAR(2)) AS X_HEADER16,' +					
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY07 +'THEN SALES'+P_TIMERANGE07 +' ELSE 0 END) AS TODAY_SALES17,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY07 +'THEN SALES'+P_TIMERANGE07 +' ELSE 0 END) AS LASTWEEK_SALES17,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY07 +'THEN SALES'+P_TIMERANGE07 +' ELSE 0 END) AS TODAY_CNT17,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY07 +'THEN SALES'+P_TIMERANGE07 +' ELSE 0 END) AS LASTWEEK_CNT17,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT17,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT17,' +
                                '                    CAST( '''+P_TIMERANGE07+''' AS VARCHAR(2)) AS X_HEADER17,' +							
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY06 +'THEN SALES'+P_TIMERANGE06 +' ELSE 0 END) AS TODAY_SALES18,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY06 +'THEN SALES'+P_TIMERANGE06 +' ELSE 0 END) AS LASTWEEK_SALES18,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY06 +'THEN SALES'+P_TIMERANGE06 +' ELSE 0 END) AS TODAY_CNT18,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY06 +'THEN SALES'+P_TIMERANGE06 +' ELSE 0 END) AS LASTWEEK_CNT18,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT18,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT18,' +
                                '                    CAST( '''+P_TIMERANGE06+''' AS VARCHAR(2)) AS X_HEADER18,' +								
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY05 +'THEN SALES'+P_TIMERANGE05 +' ELSE 0 END) AS TODAY_SALES19,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY05 +'THEN SALES'+P_TIMERANGE05 +' ELSE 0 END) AS LASTWEEK_SALES19,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY05 +'THEN SALES'+P_TIMERANGE05 +' ELSE 0 END) AS TODAY_CNT19,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY05 +'THEN SALES'+P_TIMERANGE05 +' ELSE 0 END) AS LASTWEEK_CNT19,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT19,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT19,' +
                                '                    CAST( '''+P_TIMERANGE05+''' AS VARCHAR(2)) AS X_HEADER19,' +	
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY04 +'THEN SALES'+P_TIMERANGE04 +' ELSE 0 END) AS TODAY_SALES20,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY04 +'THEN SALES'+P_TIMERANGE04 +' ELSE 0 END) AS LASTWEEK_SALES20,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY04 +'THEN SALES'+P_TIMERANGE04 +' ELSE 0 END) AS TODAY_CNT20,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY04 +'THEN SALES'+P_TIMERANGE04 +' ELSE 0 END) AS LASTWEEK_CNT20,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT20,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT20,' +
                                '                    CAST( '''+P_TIMERANGE04+''' AS VARCHAR(2)) AS X_HEADER20,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY03 +'THEN SALES'+P_TIMERANGE03 +' ELSE 0 END) AS TODAY_SALES21,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY03 +'THEN SALES'+P_TIMERANGE03 +' ELSE 0 END) AS LASTWEEK_SALES21,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY03 +'THEN SALES'+P_TIMERANGE03 +' ELSE 0 END) AS TODAY_CNT21,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY03 +'THEN SALES'+P_TIMERANGE03 +' ELSE 0 END) AS LASTWEEK_CNT21,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT21,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT21,' +
                                '                    CAST( '''+P_TIMERANGE03+''' AS VARCHAR(2)) AS X_HEADER21,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY02 +'THEN SALES'+P_TIMERANGE02 +' ELSE 0 END) AS TODAY_SALES22,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY02 +'THEN SALES'+P_TIMERANGE02 +' ELSE 0 END) AS LASTWEEK_SALES22,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY02 +'THEN SALES'+P_TIMERANGE02 +' ELSE 0 END) AS TODAY_CNT22,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY02 +'THEN SALES'+P_TIMERANGE02 +' ELSE 0 END) AS LASTWEEK_CNT22,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT22,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT22,' +
                                '                    CAST( '''+P_TIMERANGE02+''' AS VARCHAR(2)) AS X_HEADER22,' +			
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY01 +'THEN SALES'+P_TIMERANGE01 +' ELSE 0 END) AS TODAY_SALES23,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY01 +'THEN SALES'+P_TIMERANGE01 +' ELSE 0 END) AS LASTWEEK_SALES23,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY01 +'THEN SALES'+P_TIMERANGE01 +' ELSE 0 END) AS TODAY_CNT23,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY01 +'THEN SALES'+P_TIMERANGE01 +' ELSE 0 END) AS LASTWEEK_CNT23,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT23,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT23,' +
                                '                    CAST( '''+P_TIMERANGE01+''' AS VARCHAR(2)) AS X_HEADER23' +									
                                '   FROM PMART.TSC_SALES_DAY DATA' +
	                            '                 INNER JOIN PMART.LAST_ORG_STORE S ON DATA.OSTORE_NO=S.OSTORE_ID' +
                                '                 INNER JOIN (' +
  		                        '                                            SELECT ORG.ORG_ID,P.DEPT_NO AS DEPT_ID,P.DEPT_SNAME AS DEPT_NAME' +
		                        '                                                  FROM PMART.VW_ORG_DIM  ORG' +
			                    '                                                                INNER JOIN PMART.ORG_DEPT P ON  ORG.PARENT_ORG_ID = P.DEPT_ID' +
		                        '                                               WHERE ORG.ORG_LEVEL=2' +
		                        '                                           ) D ON S.BRANCH_ID=D.ORG_ID	 ' +
                                'WHERE (DATA.DAY_ID = '+P_DAY24 +
	       			            '                    OR DATA.DAY_ID = '+P_LW_DAY24+
								'                    OR DATA.DAY_ID = '+P_DAY+
								'                    OR DATA.DAY_ID = '+P_LW_DAY+
				                ') ' +
                                'GROUP BY   D.DEPT_ID,D.DEPT_NAME';	 
	 EXECUTE IMMEDIATE SQLSTR;   
SET SQLSTR ='UPDATE T '+
                           'FROM PMART.TSC_SALES_DAY_24H T, '+
                           '( '+
                           'SELECT D.DEPT_ID,D.DEPT_NAME '+
                           ',SUM(SALES'+P_TIMERANGE24+') AS LASTWEEK_SALES_AMT00,SUM(CNT'+P_TIMERANGE24+') AS LASTWEEK_SALES_CNT00 '+
                           ',SUM(SALES'+P_TIMERANGE23+') AS LASTWEEK_SALES_AMT01,SUM(CNT'+P_TIMERANGE23+') AS LASTWEEK_SALES_CNT01 '+
                           ',SUM(SALES'+P_TIMERANGE22+') AS LASTWEEK_SALES_AMT02,SUM(CNT'+P_TIMERANGE22+') AS LASTWEEK_SALES_CNT02 '+
                           ',SUM(SALES'+P_TIMERANGE21+') AS LASTWEEK_SALES_AMT03,SUM(CNT'+P_TIMERANGE21+') AS LASTWEEK_SALES_CNT03 '+
                           ',SUM(SALES'+P_TIMERANGE20+') AS LASTWEEK_SALES_AMT04,SUM(CNT'+P_TIMERANGE20+') AS LASTWEEK_SALES_CNT04 '+
                           ',SUM(SALES'+P_TIMERANGE19+') AS LASTWEEK_SALES_AMT05,SUM(CNT'+P_TIMERANGE19+') AS LASTWEEK_SALES_CNT05 '+
                           ',SUM(SALES'+P_TIMERANGE18+') AS LASTWEEK_SALES_AMT06,SUM(CNT'+P_TIMERANGE18+') AS LASTWEEK_SALES_CNT06 '+
                           ',SUM(SALES'+P_TIMERANGE17+') AS LASTWEEK_SALES_AMT07,SUM(CNT'+P_TIMERANGE17+') AS LASTWEEK_SALES_CNT07 '+
                           ',SUM(SALES'+P_TIMERANGE16+') AS LASTWEEK_SALES_AMT08,SUM(CNT'+P_TIMERANGE16+') AS LASTWEEK_SALES_CNT08 '+
                           ',SUM(SALES'+P_TIMERANGE15+') AS LASTWEEK_SALES_AMT09,SUM(CNT'+P_TIMERANGE15+') AS LASTWEEK_SALES_CNT09 '+
                           ',SUM(SALES'+P_TIMERANGE14+') AS LASTWEEK_SALES_AMT10,SUM(CNT'+P_TIMERANGE14+') AS LASTWEEK_SALES_CNT10 '+
                           ',SUM(SALES'+P_TIMERANGE13+') AS LASTWEEK_SALES_AMT11,SUM(CNT'+P_TIMERANGE13+') AS LASTWEEK_SALES_CNT11 '+
                           ',SUM(SALES'+P_TIMERANGE12+') AS LASTWEEK_SALES_AMT12,SUM(CNT'+P_TIMERANGE12+') AS LASTWEEK_SALES_CNT12 '+
                           ',SUM(SALES'+P_TIMERANGE11+') AS LASTWEEK_SALES_AMT13,SUM(CNT'+P_TIMERANGE11+') AS LASTWEEK_SALES_CNT13 '+
                           ',SUM(SALES'+P_TIMERANGE10+') AS LASTWEEK_SALES_AMT14,SUM(CNT'+P_TIMERANGE10+') AS LASTWEEK_SALES_CNT14 '+
                           ',SUM(SALES'+P_TIMERANGE09+') AS LASTWEEK_SALES_AMT15,SUM(CNT'+P_TIMERANGE09+') AS LASTWEEK_SALES_CNT15 '+
                           ',SUM(SALES'+P_TIMERANGE08+') AS LASTWEEK_SALES_AMT16,SUM(CNT'+P_TIMERANGE08+') AS LASTWEEK_SALES_CNT16 '+
                           ',SUM(SALES'+P_TIMERANGE07+') AS LASTWEEK_SALES_AMT17,SUM(CNT'+P_TIMERANGE07+') AS LASTWEEK_SALES_CNT17 '+
                           ',SUM(SALES'+P_TIMERANGE06+') AS LASTWEEK_SALES_AMT18,SUM(CNT'+P_TIMERANGE06+') AS LASTWEEK_SALES_CNT18 '+
                           ',SUM(SALES'+P_TIMERANGE05+') AS LASTWEEK_SALES_AMT19,SUM(CNT'+P_TIMERANGE05+') AS LASTWEEK_SALES_CNT19'+	
                           ',SUM(SALES'+P_TIMERANGE04+') AS LASTWEEK_SALES_AMT20,SUM(CNT'+P_TIMERANGE04+') AS LASTWEEK_SALES_CNT20 '+
                           ',SUM(SALES'+P_TIMERANGE03+') AS LASTWEEK_SALES_AMT21,SUM(CNT'+P_TIMERANGE03+') AS LASTWEEK_SALES_CNT21 '+
                           ',SUM(SALES'+P_TIMERANGE02+') AS LASTWEEK_SALES_AMT22,SUM(CNT'+P_TIMERANGE02+') AS LASTWEEK_SALES_CNT22 '+
                           ',SUM(SALES'+P_TIMERANGE01+') AS LASTWEEK_SALES_AMT23,SUM(CNT'+P_TIMERANGE01+') AS LASTWEEK_SALES_CNT23 '+
	         'FROM PMART.TSC_SALES_WEEK_AVG DATA '+
	         '              INNER JOIN PMART.LAST_ORG_STORE S ON DATA.OSTORE_NO=S.OSTORE_ID '+
             '               INNER JOIN ( '+
  		     '                                            SELECT ORG.ORG_ID,P.DEPT_NO AS DEPT_ID,P.DEPT_SNAME AS DEPT_NAME '+
		     '                                                FROM PMART.VW_ORG_DIM  ORG '+
			 '                                                               INNER JOIN PMART.ORG_DEPT P ON  ORG.PARENT_ORG_ID = P.DEPT_ID '+
		     '                                            WHERE ORG.ORG_LEVEL=2 '+
		     '                                          ) D ON S.BRANCH_ID=D.ORG_ID	  '+
             ' GROUP BY D.DEPT_ID,D.DEPT_NAME '+
             ') DAT  '+
             'SET LASTWEEK_SALES_AMT00=DAT.LASTWEEK_SALES_AMT00,LASTWEEK_SALES_CNT00=DAT.LASTWEEK_SALES_CNT00 '+
             '         ,LASTWEEK_SALES_AMT01=DAT.LASTWEEK_SALES_AMT01,LASTWEEK_SALES_CNT01=DAT.LASTWEEK_SALES_CNT01 '+
             '         ,LASTWEEK_SALES_AMT02=DAT.LASTWEEK_SALES_AMT02,LASTWEEK_SALES_CNT02=DAT.LASTWEEK_SALES_CNT02 '+
             '         ,LASTWEEK_SALES_AMT03=DAT.LASTWEEK_SALES_AMT03,LASTWEEK_SALES_CNT03=DAT.LASTWEEK_SALES_CNT03 '+
             '         ,LASTWEEK_SALES_AMT04=DAT.LASTWEEK_SALES_AMT04,LASTWEEK_SALES_CNT04=DAT.LASTWEEK_SALES_CNT04 '+
             '         ,LASTWEEK_SALES_AMT05=DAT.LASTWEEK_SALES_AMT05,LASTWEEK_SALES_CNT05=DAT.LASTWEEK_SALES_CNT05 '+
             '         ,LASTWEEK_SALES_AMT06=DAT.LASTWEEK_SALES_AMT06,LASTWEEK_SALES_CNT06=DAT.LASTWEEK_SALES_CNT06 '+
             '         ,LASTWEEK_SALES_AMT07=DAT.LASTWEEK_SALES_AMT07,LASTWEEK_SALES_CNT07=DAT.LASTWEEK_SALES_CNT07 '+
             '         ,LASTWEEK_SALES_AMT08=DAT.LASTWEEK_SALES_AMT08,LASTWEEK_SALES_CNT08=DAT.LASTWEEK_SALES_CNT08 '+
             '         ,LASTWEEK_SALES_AMT09=DAT.LASTWEEK_SALES_AMT09,LASTWEEK_SALES_CNT09=DAT.LASTWEEK_SALES_CNT09 '+
             '         ,LASTWEEK_SALES_AMT10=DAT.LASTWEEK_SALES_AMT10,LASTWEEK_SALES_CNT10=DAT.LASTWEEK_SALES_CNT10 '+
             '         ,LASTWEEK_SALES_AMT11=DAT.LASTWEEK_SALES_AMT11,LASTWEEK_SALES_CNT11=DAT.LASTWEEK_SALES_CNT11 '+
             '         ,LASTWEEK_SALES_AMT12=DAT.LASTWEEK_SALES_AMT12,LASTWEEK_SALES_CNT12=DAT.LASTWEEK_SALES_CNT12 '+
             '         ,LASTWEEK_SALES_AMT13=DAT.LASTWEEK_SALES_AMT13,LASTWEEK_SALES_CNT13=DAT.LASTWEEK_SALES_CNT13 '+
             '         ,LASTWEEK_SALES_AMT14=DAT.LASTWEEK_SALES_AMT14,LASTWEEK_SALES_CNT14=DAT.LASTWEEK_SALES_CNT14 '+
             '         ,LASTWEEK_SALES_AMT15=DAT.LASTWEEK_SALES_AMT15,LASTWEEK_SALES_CNT15=DAT.LASTWEEK_SALES_CNT15 '+
             '         ,LASTWEEK_SALES_AMT16=DAT.LASTWEEK_SALES_AMT16,LASTWEEK_SALES_CNT16=DAT.LASTWEEK_SALES_CNT16 '+
             '         ,LASTWEEK_SALES_AMT17=DAT.LASTWEEK_SALES_AMT17,LASTWEEK_SALES_CNT17=DAT.LASTWEEK_SALES_CNT17 '+
             '         ,LASTWEEK_SALES_AMT18=DAT.LASTWEEK_SALES_AMT18,LASTWEEK_SALES_CNT18=DAT.LASTWEEK_SALES_CNT18 '+
             '         ,LASTWEEK_SALES_AMT19=DAT.LASTWEEK_SALES_AMT19,LASTWEEK_SALES_CNT19=DAT.LASTWEEK_SALES_CNT19 '+
             '         ,LASTWEEK_SALES_AMT20=DAT.LASTWEEK_SALES_AMT20,LASTWEEK_SALES_CNT20=DAT.LASTWEEK_SALES_CNT20 '+
             '         ,LASTWEEK_SALES_AMT21=DAT.LASTWEEK_SALES_AMT21,LASTWEEK_SALES_CNT21=DAT.LASTWEEK_SALES_CNT21 '+
             '         ,LASTWEEK_SALES_AMT22=DAT.LASTWEEK_SALES_AMT22,LASTWEEK_SALES_CNT22=DAT.LASTWEEK_SALES_CNT22 '+
             '         ,LASTWEEK_SALES_AMT23=DAT.LASTWEEK_SALES_AMT23,LASTWEEK_SALES_CNT23=DAT.LASTWEEK_SALES_CNT23 '+
             '         WHERE T.DEPT_ID = DAT.DEPT_ID	  ';
	 EXECUTE IMMEDIATE SQLSTR;   	 
	 SET SQLSTR ='INSERT INTO PMART.TSC_SALES_DAY_8H(DATA_DAY,DEPT_ID,DEPT_NAME' +
	                            '  ,TODAY_SALES00,LASTWEEK_SALES00,TODAY_CNT00,LASTWEEK_CNT00,LASTWEEK_SALES_AMT00,LASTWEEK_SALES_CNT00,X_HEADER00 '+
								 '  ,TODAY_SALES01,LASTWEEK_SALES01,TODAY_CNT01,LASTWEEK_CNT01,LASTWEEK_SALES_AMT01,LASTWEEK_SALES_CNT01,X_HEADER01 '+
								 '  ,TODAY_SALES02,LASTWEEK_SALES02,TODAY_CNT02,LASTWEEK_CNT02,LASTWEEK_SALES_AMT02,LASTWEEK_SALES_CNT02,X_HEADER02 '+
								 '  ,TODAY_SALES03,LASTWEEK_SALES03,TODAY_CNT03,LASTWEEK_CNT03,LASTWEEK_SALES_AMT03,LASTWEEK_SALES_CNT03,X_HEADER03 '+
								 '  ,TODAY_SALES04,LASTWEEK_SALES04,TODAY_CNT04,LASTWEEK_CNT04,LASTWEEK_SALES_AMT04,LASTWEEK_SALES_CNT04,X_HEADER04 '+
								 '  ,TODAY_SALES05,LASTWEEK_SALES05,TODAY_CNT05,LASTWEEK_CNT05,LASTWEEK_SALES_AMT05,LASTWEEK_SALES_CNT05,X_HEADER05 '+
								 '  ,TODAY_SALES06,LASTWEEK_SALES06,TODAY_CNT06,LASTWEEK_CNT06,LASTWEEK_SALES_AMT06,LASTWEEK_SALES_CNT06,X_HEADER06 '+
								 '  ,TODAY_SALES07,LASTWEEK_SALES07,TODAY_CNT07,LASTWEEK_CNT07,LASTWEEK_SALES_AMT07,LASTWEEK_SALES_CNT07,X_HEADER07 '+
								')' +
                                'SELECT  CAST(TO_CHAR(CURRENT_DATE,''YYYYMMDD'')AS INTEGER)  AS DATA_DAY,' +
                                '                    D.DEPT_ID,' +
                                '                    D.DEPT_NAME,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY08 +'THEN SALES'+P_TIMERANGE08 +' ELSE 0 END) AS TODAY_SALES00,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY08 +'THEN SALES'+P_TIMERANGE08 +' ELSE 0 END) AS LASTWEEK_SALES00,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY08 +'THEN SALES'+P_TIMERANGE08 +' ELSE 0 END) AS TODAY_CNT00,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY08 +'THEN SALES'+P_TIMERANGE08 +' ELSE 0 END) AS LASTWEEK_CNT00,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT00,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT00,' +
                                '                    CAST( '''+P_TIMERANGE08+''' AS VARCHAR(2)) AS X_HEADER00,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY07 +'THEN SALES'+P_TIMERANGE07 +' ELSE 0 END) AS TODAY_SALES01,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY07 +'THEN SALES'+P_TIMERANGE07 +' ELSE 0 END) AS LASTWEEK_SALES01,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY07 +'THEN SALES'+P_TIMERANGE07 +' ELSE 0 END) AS TODAY_CNT01,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY07 +'THEN SALES'+P_TIMERANGE07 +' ELSE 0 END) AS LASTWEEK_CNT01,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT01,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT01,' +
                                '                    CAST( '''+P_TIMERANGE07+''' AS VARCHAR(2)) AS X_HEADER01,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY06 +'THEN SALES'+P_TIMERANGE06 +' ELSE 0 END) AS TODAY_SALES02,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY06 +'THEN SALES'+P_TIMERANGE06 +' ELSE 0 END) AS LASTWEEK_SALES02,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY06 +'THEN SALES'+P_TIMERANGE06 +' ELSE 0 END) AS TODAY_CNT02,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY06 +'THEN SALES'+P_TIMERANGE06 +' ELSE 0 END) AS LASTWEEK_CNT02,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT02,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT02,' +
                                '                    CAST( '''+P_TIMERANGE06+''' AS VARCHAR(2)) AS X_HEADER02,' +			
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY05 +'THEN SALES'+P_TIMERANGE05 +' ELSE 0 END) AS TODAY_SALES03,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY05 +'THEN SALES'+P_TIMERANGE05 +' ELSE 0 END) AS LASTWEEK_SALES03,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY05 +'THEN SALES'+P_TIMERANGE05 +' ELSE 0 END) AS TODAY_CNT03,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY05 +'THEN SALES'+P_TIMERANGE05 +' ELSE 0 END) AS LASTWEEK_CNT03,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT03,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT03,' +
                                '                    CAST( '''+P_TIMERANGE05+''' AS VARCHAR(2)) AS X_HEADER03,' +		
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY04 +'THEN SALES'+P_TIMERANGE04 +' ELSE 0 END) AS TODAY_SALES04,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY04 +'THEN SALES'+P_TIMERANGE04 +' ELSE 0 END) AS LASTWEEK_SALES04,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY04 +'THEN SALES'+P_TIMERANGE04 +' ELSE 0 END) AS TODAY_CNT04,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY04 +'THEN SALES'+P_TIMERANGE04 +' ELSE 0 END) AS LASTWEEK_CNT04,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT04,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT04,' +
                                '                    CAST( '''+P_TIMERANGE04+''' AS VARCHAR(2)) AS X_HEADER04,' +			
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY03 +'THEN SALES'+P_TIMERANGE03 +' ELSE 0 END) AS TODAY_SALES05,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY03 +'THEN SALES'+P_TIMERANGE03 +' ELSE 0 END) AS LASTWEEK_SALES05,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY03 +'THEN SALES'+P_TIMERANGE03 +' ELSE 0 END) AS TODAY_CNT05,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY03 +'THEN SALES'+P_TIMERANGE03 +' ELSE 0 END) AS LASTWEEK_CNT05,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT05,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT05,' +
                                '                    CAST( '''+P_TIMERANGE03+''' AS VARCHAR(2)) AS X_HEADER05,' +								
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY02 +'THEN SALES'+P_TIMERANGE02 +' ELSE 0 END) AS TODAY_SALES06,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY02 +'THEN SALES'+P_TIMERANGE02 +' ELSE 0 END) AS LASTWEEK_SALES06,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY02 +'THEN SALES'+P_TIMERANGE02 +' ELSE 0 END) AS TODAY_CNT06,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY02 +'THEN SALES'+P_TIMERANGE02 +' ELSE 0 END) AS LASTWEEK_CNT06,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT06,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT06,' +
                                '                    CAST( '''+P_TIMERANGE02+''' AS VARCHAR(2)) AS X_HEADER06,' +					
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_DAY01 +'THEN SALES'+P_TIMERANGE01 +' ELSE 0 END) AS TODAY_SALES07,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=1 AND DATA.DAY_ID='+P_LW_DAY01 +'THEN SALES'+P_TIMERANGE01 +' ELSE 0 END) AS LASTWEEK_SALES07,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_DAY01 +'THEN SALES'+P_TIMERANGE01 +' ELSE 0 END) AS TODAY_CNT07,' +
                                '                    SUM(CASE WHEN  DATA.DATA_TYPE=2 AND DATA.DAY_ID='+P_LW_DAY01 +'THEN SALES'+P_TIMERANGE01 +' ELSE 0 END) AS LASTWEEK_CNT07,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_AMT07,' +
                                '                    CAST( 0 AS INTEGER) AS LASTWEEK_SALES_CNT07,' +
                                '                    CAST( '''+P_TIMERANGE01+''' AS VARCHAR(2)) AS X_HEADER07' +										
                                '   FROM PMART.TSC_SALES_DAY DATA' +
	                            '                 INNER JOIN PMART.LAST_ORG_STORE S ON DATA.OSTORE_NO=S.OSTORE_ID' +
                                '                 INNER JOIN (' +
  		                        '                                            SELECT ORG.ORG_ID,P.DEPT_NO AS DEPT_ID,P.DEPT_SNAME AS DEPT_NAME' +
		                        '                                                  FROM PMART.VW_ORG_DIM  ORG' +
			                    '                                                                INNER JOIN PMART.ORG_DEPT P ON  ORG.PARENT_ORG_ID = P.DEPT_ID' +
		                        '                                               WHERE ORG.ORG_LEVEL=2' +
		                        '                                           ) D ON S.BRANCH_ID=D.ORG_ID	 ' +
                                'WHERE (DATA.DAY_ID = '+P_DAY08 +
	       			            '                    OR DATA.DAY_ID = '+P_LW_DAY08+
								'                    OR DATA.DAY_ID = '+P_DAY+
								'                    OR DATA.DAY_ID = '+P_LW_DAY+
				                ') ' +
                                'GROUP BY   D.DEPT_ID,D.DEPT_NAME';	 
	 EXECUTE IMMEDIATE SQLSTR;   
SET SQLSTR ='UPDATE T '+
                           'FROM PMART.TSC_SALES_DAY_8H T, '+
                           '( '+
                           'SELECT D.DEPT_ID,D.DEPT_NAME '+
                           ',SUM(SALES'+P_TIMERANGE08+') AS LASTWEEK_SALES_AMT00,SUM(CNT'+P_TIMERANGE08+') AS LASTWEEK_SALES_CNT00 '+
                           ',SUM(SALES'+P_TIMERANGE07+') AS LASTWEEK_SALES_AMT01,SUM(CNT'+P_TIMERANGE07+') AS LASTWEEK_SALES_CNT01 '+
                           ',SUM(SALES'+P_TIMERANGE06+') AS LASTWEEK_SALES_AMT02,SUM(CNT'+P_TIMERANGE06+') AS LASTWEEK_SALES_CNT02 '+
                           ',SUM(SALES'+P_TIMERANGE05+') AS LASTWEEK_SALES_AMT03,SUM(CNT'+P_TIMERANGE05+') AS LASTWEEK_SALES_CNT03 '+
                           ',SUM(SALES'+P_TIMERANGE04+') AS LASTWEEK_SALES_AMT04,SUM(CNT'+P_TIMERANGE04+') AS LASTWEEK_SALES_CNT04 '+
                           ',SUM(SALES'+P_TIMERANGE03+') AS LASTWEEK_SALES_AMT05,SUM(CNT'+P_TIMERANGE03+') AS LASTWEEK_SALES_CNT05 '+
                           ',SUM(SALES'+P_TIMERANGE02+') AS LASTWEEK_SALES_AMT06,SUM(CNT'+P_TIMERANGE02+') AS LASTWEEK_SALES_CNT06 '+
                           ',SUM(SALES'+P_TIMERANGE01+') AS LASTWEEK_SALES_AMT07,SUM(CNT'+P_TIMERANGE01+') AS LASTWEEK_SALES_CNT07 '+
	         'FROM PMART.TSC_SALES_WEEK_AVG DATA '+
	         '              INNER JOIN PMART.LAST_ORG_STORE S ON DATA.OSTORE_NO=S.OSTORE_ID '+
             '               INNER JOIN ( '+
  		     '                                            SELECT ORG.ORG_ID,P.DEPT_NO AS DEPT_ID,P.DEPT_SNAME AS DEPT_NAME '+
		     '                                                FROM PMART.VW_ORG_DIM  ORG '+
			 '                                                               INNER JOIN PMART.ORG_DEPT P ON  ORG.PARENT_ORG_ID = P.DEPT_ID '+
		     '                                            WHERE ORG.ORG_LEVEL=2 '+
		     '                                          ) D ON S.BRANCH_ID=D.ORG_ID	  '+
             ' GROUP BY D.DEPT_ID,D.DEPT_NAME '+
             ') DAT  '+
             'SET LASTWEEK_SALES_AMT00=DAT.LASTWEEK_SALES_AMT00,LASTWEEK_SALES_CNT00=DAT.LASTWEEK_SALES_CNT00 '+
             '         ,LASTWEEK_SALES_AMT01=DAT.LASTWEEK_SALES_AMT01,LASTWEEK_SALES_CNT01=DAT.LASTWEEK_SALES_CNT01 '+
             '         ,LASTWEEK_SALES_AMT02=DAT.LASTWEEK_SALES_AMT02,LASTWEEK_SALES_CNT02=DAT.LASTWEEK_SALES_CNT02 '+
             '         ,LASTWEEK_SALES_AMT03=DAT.LASTWEEK_SALES_AMT03,LASTWEEK_SALES_CNT03=DAT.LASTWEEK_SALES_CNT03 '+
             '         ,LASTWEEK_SALES_AMT04=DAT.LASTWEEK_SALES_AMT04,LASTWEEK_SALES_CNT04=DAT.LASTWEEK_SALES_CNT04 '+
             '         ,LASTWEEK_SALES_AMT05=DAT.LASTWEEK_SALES_AMT05,LASTWEEK_SALES_CNT05=DAT.LASTWEEK_SALES_CNT05 '+
             '         ,LASTWEEK_SALES_AMT06=DAT.LASTWEEK_SALES_AMT06,LASTWEEK_SALES_CNT06=DAT.LASTWEEK_SALES_CNT06 '+
             '         ,LASTWEEK_SALES_AMT07=DAT.LASTWEEK_SALES_AMT07,LASTWEEK_SALES_CNT07=DAT.LASTWEEK_SALES_CNT07 '+
             '         WHERE T.DEPT_ID = DAT.DEPT_ID	  ';
	 EXECUTE IMMEDIATE SQLSTR;   	 	 
END SP;