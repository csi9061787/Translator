REPLACE PROCEDURE PMART.REMD_T3_GRP_FUNC
(P_L_DAY_ID NUMBER,P_ORG_ID NUMBER)
SQL SECURITY INVOKER
SP:BEGIN
DECLARE SQLSTR  VARCHAR(4000) DEFAULT ''; 
  CALL PMART.P_DROP_TABLE ('#VT_REMD_T3_GRP_FUNC'); 
      SET SQLSTR = 
          'CREATE MULTISET VOLATILE TABLE #VT_REMD_T3_GRP_FUNC AS('+            
                'SELECT '+
                'A.GRP_ID AS STYPE_ID, '+
                'A.TOT_AMT  AS TOT_AMT_LAST_YEAR, '+
                'A.TOT_CUST_NUM AS TOT_CUST_NUM_LAST_YEAR, '+
                'A.TOT_TKSL AS TOT_TKSL_LAST_YEAR '+
                'FROM PMART.REMD_FACT_GRP_SUM A, '+
                '(SELECT GRP_ID FROM PMART.REMD_GRP_M) B '+
                'WHERE A.GRP_ID=B.GRP_ID AND '+
                'A.ORG_ID='+P_ORG_ID+' AND '+
                'A.L_DAY_ID=ROUND('+P_L_DAY_ID+'/100)*100+1-10000 '+
           ' ) WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;';
    EXECUTE IMMEDIATE SQLSTR; 
END SP;