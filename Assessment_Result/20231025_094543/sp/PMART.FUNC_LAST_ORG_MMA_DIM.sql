CREATE PROCEDURE PMART.FUNC_LAST_ORG_MMA_DIM
(
	 P_INPUT_TYPE INTEGER,	
	 P_INPUT_VALUE  INTEGER  
)
SQL SECURITY INVOKER
SP:BEGIN
DECLARE SQLSTR  VARCHAR(4000) DEFAULT ''; 
  CALL PMART.P_DROP_TABLE ('#VT_FUNC_LAST_ORG_MMA_DIM');
  SET SQLSTR = 
	' CREATE MULTISET VOLATILE TABLE #VT_FUNC_LAST_ORG_MMA_DIM AS('
  	+ ' SELECT   MMA_ID ,MMA_NM '
    + ' FROM PMART.LAST_ORG_MMA_DIM '
	+ ' WHERE ' 
    + CASE WHEN  P_INPUT_TYPE = -1 THEN   ' TOT_ID '
	                WHEN  P_INPUT_TYPE = 1 THEN   ' PDEPT_ID '
	                WHEN  P_INPUT_TYPE = 2 THEN   ' DEPT_ID '
	                WHEN  P_INPUT_TYPE = 3 THEN   ' BRANCH_ID '
	                WHEN  P_INPUT_TYPE = 4 THEN   ' RESPON_ID '
	                WHEN  P_INPUT_TYPE = 5 THEN   ' OSTORE_ID '
	                ELSE '' END
	+ ' = ' + P_INPUT_VALUE
	+ ' GROUP BY   MMA_ID ,MMA_NM '	
	+ ') WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;';
  EXECUTE IMMEDIATE SQLSTR; 
END SP;