REPLACE   PROCEDURE PMART.PS_MMA_ID
(
)
SQL SECURITY INVOKER
SP:BEGIN
	DECLARE SQLSTR  VARCHAR(20000);
	DECLARE SQLCREATE  VARCHAR(30000);
	DECLARE P_JOB_ID  VARCHAR(20000);
	SET P_JOB_ID = (SELECT *  FROM #VT_PS_JOB_ID);
 	CALL PMART.P_DROP_TABLE ('#VT_PS_MMA_ID');
SET SQLSTR = ' 
SELECT MMA_ID FROM  PDATA.PRDREL_SET WHERE  JOB_ID = '+P_JOB_ID+'
'
; 
   SET SQLCREATE = 
   'CREATE MULTISET VOLATILE TABLE  #VT_PS_MMA_ID AS( '
   +SQLSTR 
   +'	) WITH DATA PRIMARY INDEX(MMA_ID) ON COMMIT PRESERVE ROWS;'
   ;
INSERT INTO PMART.T1(F1,F2) SELECT 20200630,SQLCREATE;
EXECUTE IMMEDIATE SQLCREATE;   
END SP;