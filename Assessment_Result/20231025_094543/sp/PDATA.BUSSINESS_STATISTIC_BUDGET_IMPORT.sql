CREATE PROCEDURE PDATA.BUSSINESS_STATISTIC_BUDGET_IMPORT
(
OUT DATA_CNT INTEGER
)
SQL SECURITY INVOKER
SP:BEGIN
DECLARE  DATA_TIMESTAMP INTEGER;
SET DATA_TIMESTAMP =CAST(TO_CHAR(CURRENT_DATE, 'YYYYMMDD') AS INT);
DELETE PDATA.BUSSINESS_STATISTIC_BUDGET  ALL;
INSERT INTO PDATA.BUSSINESS_STATISTIC_BUDGET(B_YEAR,B_MONTH,BUDGET_TYPE,ITEM_CODE ,SUB_ITEM_CODE,ORG_ID,BUDGET,UPDATE_TIME )
SELECT  B_YEAR,CAST (1 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M1 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (2 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M2 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (3 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M3 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (4 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M4 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (5 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M5 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (6 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M6 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (7 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M7 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (8 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M8 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (9 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M9 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (10 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M10 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (11 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M11 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF
UNION ALL
SELECT  B_YEAR,CAST (12 AS INT )B_MONTH,BUDGET_TYPE,CASE WHEN BUDGET_TYPE IN (1,2) THEN ITEM_CODE ELSE '' END ITEM_CODE,SUB_ITEM_CODE,
			CASE WHEN BUDGET_TYPE NOT IN (1,2) THEN ITEM_CODE ELSE '' END ORG_ID,M12 AS BUDGET,DATA_TIMESTAMP
FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF;
SET DATA_CNT = (SELECT COUNT(*) FROM PSTAGE.BUSSINESS_STATISTIC_BUDGET_IF);
END SP;