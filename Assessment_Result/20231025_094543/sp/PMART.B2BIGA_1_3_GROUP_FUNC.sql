REPLACE PROCEDURE PMART.B2BIGA_1_3_GROUP_FUNC
(
	IN P_KIND_CODE VARCHAR(20)
)
SQL SECURITY INVOKER
SP:BEGIN
   DECLARE SQLSTR VARCHAR(20000);
   CALL PMART.P_DROP_TABLE ('#VT_B2BIGA_1_3_GROUP_FUNC'); 
   SET SQLSTR ='CREATE MULTISET VOLATILE TABLE #VT_B2BIGA_1_3_GROUP_FUNC  AS( '
        + ' SELECT DISTINCT A.GROUP_CODE, B.GROUP_NAME  '
		+ ' FROM #VT_B2BIGA_1_3_KGRP A, PDATA.PBMKGRP B '
		+ ' WHERE A.KIND_CODE = B.KIND_CODE '
		+ ' AND A.GROUP_CODE = B.GROUP_CODE '
		+ ' AND A.KIND_CODE = '''+ P_KIND_CODE + ''' '
		+ ' ) WITH DATA NO PRIMARY INDEX ON COMMIT PRESERVE ROWS;' ; 
	EXECUTE IMMEDIATE SQLSTR;
END SP;